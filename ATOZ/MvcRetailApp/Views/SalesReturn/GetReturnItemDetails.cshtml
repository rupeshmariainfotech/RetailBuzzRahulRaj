@model CodeFirstEntities.MainApplication
@{
    ViewBag.Title = "GetReturnItemDetails";
}
<script type="text/javascript">
    $(function () {
        if (document.getElementById("BillType").value == "Sales Bill") {
            document.getElementById("InvButton").style.display = "none";
            document.getElementById("NonInvButton").style.display = "none";
            $("#NewItemButtons").append("<div style='height:10px'></div>");
        }
    });
</script>
<script type="text/javascript">
    function addCommas(yourNumber) {
        var components = yourNumber.toString().split(".");
        if (components.length === 1)
            components[0] = yourNumber;
        components[0] = components[0].replace(/\D/g, "").replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        if (components.length === 2)
            components[1] = components[1].replace(/\D/g, "");
        return components.join(".");
    }

    function removeCommas(yourNumber) {
        var components = yourNumber.toString().split(".");
        if (components.length === 1)
            components[0] = yourNumber;
        components[0] = components[0].replace(/\D/g, "").replace(/\B(?=(\d{3})+(?!\d))/g, '');
        if (components.length === 2)
            components[1] = components[1].replace(/\D/g, "");
        return components.join(".");
    }
</script>

<script type="text/javascript">
    function AllowNumbers(key) {
        var keycode = (key.which) ? key.which : key.keyCode;
        //comparing pressed keycodes
        if (!(keycode == 8 || keycode == 46) && (keycode < 48 || keycode > 57)) {
            return false;
        }
    }

    function AllowNumbersWithoutDecimal(key) {
        var keycode = (key.which) ? key.which : key.keyCode;
        //comparing pressed keycodes
        if (!(keycode == 8) && (keycode < 48 || keycode > 57)) {
            return false;
        }
    }

    function AllowDecimal(key, rowid) {
        var numbertype = $("#numberType" + rowid).val();
        var quantity = $("#quantity" + rowid).val();

        var pointFoundCount = 0;
        for (var i = 0; i <= quantity.length; i++) {
            if (quantity[i] == '.') {
                pointFoundCount++;
            }
        }

        var pointposition = quantity.indexOf(".");
        var digitupto = 0;
        if (pointposition != -1) {
            digitupto = quantity.substr(pointposition, quantity.length).length;
        }

        var keycode = (key.which) ? key.which : key.keyCode;
        //comparing pressed keycodes
        if (numbertype == 'Whole') { //if unit type is whole number then don't allow point
            if (!(keycode == 8) && (keycode < 48 || keycode > 57)) {
                return false;
            }
        }
        else if (quantity.length == 0) {
            if (!(keycode == 8) && (keycode < 48 || keycode > 57)) {
                return false;
            }
        }
        else if (keycode == 46) { //if decimal point is inserted
            if (pointFoundCount > 0 && pointFoundCount < 2) { // more than one decimal point is inserted then don't allow to insert it
                return false;
            }
        }
        else if (digitupto != 0) { // if unit type is decimal then wait for decimal point to be insert then execute this condition 
            if (numbertype == '2Digit') { // if unit type is 2 digit the then allow 2 digits after decimal not the characters in between
                if (!(keycode == 8 || keycode == 46) && (keycode < 48 || keycode > 57) || digitupto >= 3) {
                    return false;
                }
            }
            else { // if unit type is 2 digit the then allow 3 digits after decimal not the characters in between
                if (!(keycode == 8 || keycode == 46) && (keycode < 48 || keycode > 57) || digitupto >= 4) {
                    return false;
                }
            }
        }
        else { //don't allow any decimal point or character until first digit occurs
            if (quantity.length == 0) // if first digit is point in quantity field then don't allow it and characters too
            {
                if (!(keycode == 8) && (keycode < 48 || keycode > 57)) {
                    return false;
                }
            }
            else { //don't allow any character until the above else if condition meets
                if (!(keycode == 8 || keycode == 46) && (keycode < 48 || keycode > 57)) {
                    return false;
                }
            }
        }
    }
</script>

<script type="text/javascript">
    $(function () {

        if (document.getElementById("TotalDiscount") != null) {
            var tradediscount = +document.getElementById("TotalDiscount").innerHTML;
            document.getElementById("TotalDiscount").innerHTML = "<i class='fa fa-inr'></i>" + " " + addCommas(tradediscount.toFixed(2));
        }

        if (document.getElementById("AdvancePayment") != null) {
            var advancepayment = +document.getElementById("AdvancePayment").innerHTML;
            document.getElementById("AdvancePayment").innerHTML = "<i class='fa fa-inr'></i>" + " " + addCommas(advancepayment.toFixed(2));
        }
    });
</script>

<script type="text/javascript">
    $(function () {
        $("#InvButton").click(function () {
            var presentrows = (+document.getElementById("ItemList").value);
            var rowid = (+document.getElementById("hdnRowCount").value);
            var checkboxcount = 0;
            for (i = 1; i <= presentrows; i++) {
                var chkbox = "CheckBox" + i;
                if (!$("#" + chkbox).prop("checked")) {
                    checkboxcount++;
                }
            }
            if (checkboxcount != presentrows) {

                if (rowid > presentrows) {
                    var previtemCode = "itemCode" + rowid;
                    var prevnarration = "narration" + rowid;
                    var prevquantity = "quantity" + rowid;
                    var prevrate = "rate" + rowid;
                    var prevdiscountpercent = "discountpercent" + rowid;
                    var prevdiscountrps = "discountrps" + rowid;
                    if (document.getElementById(previtemCode) != null) {
                        //If Required Fields are Empty of Previous Row
                        if ($("#" + previtemCode).val() == "") {
                            alertbox("Please Select The Item");
                        }
                        else if ($("#" + prevquantity).val() == "" || (+$("#" + prevquantity).val()) == 0) {
                            alertbox("Please Fill The Quantity");
                        }
                        else if ($("#" + prevrate).val() == "" || (+$("#" + prevrate).val()) == 0) {
                            alertbox("Please Fill The Rate");
                        }
                        else {
                            if (document.getElementById(previtemCode).disabled != true) {
                                document.getElementById(previtemCode).disabled = true;
                                document.getElementById(prevnarration).disabled = true;
                                document.getElementById(prevquantity).disabled = true;
                                document.getElementById(prevrate).disabled = true;
                                document.getElementById(prevdiscountpercent).disabled = true;
                                document.getElementById(prevdiscountrps).disabled = true;
                            }
                            GenerateInvDynamicRow(rowid, presentrows);
                        }
                    }
                    else {
                        GenerateInvDynamicRow(rowid, presentrows);
                    }
                }
                else {
                    GenerateInvDynamicRow(rowid, presentrows);
                }
            }
            else { alertbox("Please Select At Least One Item"); }
        });
    });
</script>
<script type="text/javascript">
    function GenerateInvDynamicRow(rowid, presentrows) {
        rowid = +rowid + 1;
        var ItemType = "ItemType" + rowid;
        var row = "row" + rowid;
        var itemCode = "itemCode" + rowid;
        var itemName = "itemName" + rowid;
        var barcode = "Barcode" + rowid;
        var description = "description" + rowid;
        var narration = "narration" + rowid;
        var materialvalue = "materialvalue" + rowid;
        var color = "color" + rowid;
        var colorvalue = "colorvalue" + rowid;
        var quantity = "quantity" + rowid;
        var prevquantity = "prevquantity" + rowid;
        var shopqty = "ShopQty" + rowid;
        var rate = "rate" + rowid;
        var mrp = "MRP" + rowid;
        var discountpercent = "discountpercent" + rowid;
        var amount = "amount" + rowid;
        var amountvalue = "amountvalue" + rowid;
        var itemtax = "ItemTax" + rowid;
        var itemtaxvalue = "ItemTaxValue" + rowid;
        var itemtaxamount = "ItemTaxAmt" + rowid;
        var unit = "unit" + rowid;
        var unitvalue = "unitvalue" + rowid;
        var numbertype = "numberType" + rowid;
        var design = "design" + rowid;
        var designName = "designName" + rowid;
        var brand = "Brand" + rowid;
        var size = "Size" + rowid;
        var proportionatetax = "proportionatetax" + rowid;
        var proportionatetaxvalue = "proportionatetaxvalue" + rowid;
        var proportionateamount = "proportionatetaxamount" + rowid;

        var dynamicrow = $("#DynamicRows");
        var data = "<tr id='" + row + "'>";
        data += "<td style='text-align:center'>---</td>";
        data += "<td>" + rowid + "</td>";
        data += "<td><select id='" + itemCode + "' name='" + itemCode + "' class='form-control col-md-2 col-lg-2'><option value=''>Select</option></select><input type='hidden' id='" + itemName + "' name='" + itemName + "' /><input type='hidden' id='" + barcode + "' name='" + barcode + "' /><input type='hidden' id='" + ItemType + "' name='" + ItemType + "' value='Inventory'/><input type='hidden' id='" + brand + "' name='" + brand + "' /><input type='hidden' id='" + size + "' name='" + size + "' /></td>";
        data += "<td><input type='hidden' id='" + description + "' name='" + description + "' /><input type='text' id='" + narration + "' name='" + narration + "' class='form-control col-md-2 col-lg-2' placeholder='Narration' style='text-align:center' /><input type='hidden' id='" + designName + "' name='" + designName + "' /><input type='hidden' id='" + design + "' name='" + design + "' /><input type='hidden' id='" + materialvalue + "' name='" + materialvalue + "' /></td>";
        data += "<td><label id='" + color + "' style='text-align:center;font-weight:normal'></label><input type='hidden' id='" + colorvalue + "' name='" + colorvalue + "' /></td>";
        data += "<td style='text-align:center'><label id='" + unit + "' style='font-weight:normal'></label><input type='hidden' name='" + unitvalue + "' id='" + unitvalue + "'><input type='hidden' name='" + numbertype + "' id='" + numbertype + "'></td>";
        data += "<td style='text-align:center'><label id='" + shopqty + "'>---</label></td>"
        data += "<td style='text-align:center'><label id='" + prevquantity + "'>---</label></td>"
        data += "<td><input type='text' id='" + quantity + "' name='" + quantity + "' autocomplete='off' class='form-control col-md-1 col-lg-1' placeholder='Qty' style='text-align:center;width:100%' onchange='CalculateItemWiseAmount(" + rowid + ',' + '\"\"' + ")' onkeypress='return AllowDecimal(event," + rowid + ")' /></td>";
        data += "<td><input type='text' id='" + rate + "' name='" + rate + "' autocomplete='off' class='form-control col-md-2 col-lg-2' disabled='disabled' placeholder='Rate' style='text-align:center;width:100%' onchange='CalculateItemWiseAmount(" + rowid + ',' + '\"\"' + ")' onkeypress='return AllowNumbers(event)' /><input type='hidden' id='" + mrp + "' name='" + mrp + "'/></td>";
        data += "<td><input type='text' id='" + discountpercent + "' name='" + discountpercent + "' autocomplete='off' class='form-control col-md-1 col-lg-1' value='0' placeholder='0%' style='font-weight:normal; text-align:center;width:100%' onchange='CalculateItemWiseAmount(" + rowid + ',' + '\"percent\"' + ")' onkeypress='return AllowNumbers(event)' /></td>";
        data += "<td><input type='text' id='discountrps" + rowid + "' name='discountrps" + rowid + "'  autocomplete='off' class='form-control col-md-1 col-lg-1' value='0.00' placeholder='0' style='font-weight:normal; text-align:center;width:100%' onchange='CalculateItemWiseAmount(" + rowid + ',' + '\"rps\"' + ")' onkeypress='return AllowNumbers(event)' /></td>";
        data += "<td style='text-align:center'><label id='" + itemtax + "' style='font-weight:normal'>0</label><input type='hidden' id='" + itemtaxvalue + "' name='" + itemtaxvalue + "' value='0'/><input type='hidden' id='" + itemtaxamount + "' name='" + itemtaxamount + "' value='0'/></td>";
        data += "<td style='text-align:center'><label id='" + amount + "'style='text-align:right;font-weight:normal'>0</label><input type='hidden' id='" + amountvalue + "' name='" + amountvalue + "' value='0'/></td>";
        var salesbillno = (document.getElementById("BillNo").value).search("SB");
        if (salesbillno == 0) {
            data += "<td style='text-align:right'><label id='" + proportionatetax + "' style='font-weight:normal'>0</label><input type='hidden' id='" + proportionatetaxvalue + "' name='" + proportionatetaxvalue + "' value='0' /><input type='hidden' id='" + proportionateamount + "' name='" + proportionateamount + "' value='0' /></td>";
        }
        data += "<td><div style='height:2px'></div><a href='#' onclick='DeleteRow(" + rowid + ")' class='fa fa-trash fa-lg' style='color:red;' /></td></tr>";
        dynamicrow.append(data);
        var shopcode = document.getElementById("loginshopcode").value;
        $.getJSON("/SalesReturn/GetItemsFromShopStockAndStkDistrbtn", { ItemType: "Inventory", LoginShop: shopcode },
                function (data) {
                    var select = $("#" + itemCode);
                    select.empty();
                    select.append($('<option/>', {
                        text: "Select Item",
                        value: "",
                    }));
                    $.each(data, function (index, itemdata) {
                        select.append($('<option/>', {
                            text: itemdata.Text + " " + itemdata.Value,
                            value: itemdata.Value,
                        }));
                    });
                });
        $("#" + itemCode).change(function () {
            var name = document.getElementById(itemCode).value;
            if (name != "") {
                var currentrowid = 0;
                for (var i = rowid - 1; i >= presentrows + 1; i--) {
                    var previousitemname = "itemCode" + i;
                    if (name == $("#" + previousitemname).val()) {
                        currentrowid = i;
                        break;
                    }
                }
                if (currentrowid == 0) {
                    var validationcount = 0;
                    for (var i = presentrows + 1; i < rowid; i++) {
                        var prevquantity = "quantity" + i;
                        var prevrate = "rate" + i;
                        if (document.getElementById(prevquantity) != null) {
                            if ((+$("#" + prevquantity).val()) == 0 || $("#" + prevquantity).val() == "") {
                                alertbox("Please Fill The Quantity");
                                validationcount++;
                            }
                            else if ($("#" + prevrate).val() == "" || (+$("#" + prevrate).val()) == 0) {
                                alertbox("Please Fill The Rate");
                                validationcount++;
                            }
                            else {
                                if (document.getElementById(prevquantity).disabled == false) {
                                    document.getElementById(prevquantity).disabled = true;
                                    document.getElementById("narration" + i).disabled = true;
                                    document.getElementById(prevrate).disabled = true;
                                    document.getElementById("discountpercent" + i).disabled = true;
                                    document.getElementById("discountrps" + i).disabled = true;
                                }
                            }
                        }
                    }
                    if (validationcount == 0) {
                        $.getJSON("/SalesReturn/GetItemDetailsFromItems",
                                        {
                                            itemcode: name,
                                            Type: $("#hdnClientType").val(),
                                            State: $("#hdnClientState").val(),
                                            Formtype: $("#hdnFormType").val(),
                                            ConsumeResell: $("#hdnComsumeResell").val(),
                                            billno: $("#BillNo").val()
                                        },
                                 function (data) {
                                     document.getElementById("quantity" + rowid).value = "";
                                     document.getElementById("amount" + rowid).innerHTML = 0.00;
                                     document.getElementById("amountvalue" + rowid).innerHTML = 0.00;
                                     $("#" + itemName).val(data.ItemName);
                                     $("#" + barcode).val(data.Barcode);
                                     $("#" + description).val(data.Description);
                                     $("#" + rate).val(data.SellingPrice);
                                     $("#" + mrp).val(data.MRP);
                                     $("#" + materialvalue).val(data.typematerial);
                                     $("#" + color).text(data.colorname);
                                     $("#" + colorvalue).val(data.colorname);
                                     $("#" + unit).text(data.Unit);
                                     $("#" + unitvalue).val(data.Unit);
                                     $("#" + shopqty).text(data.shopqty);
                                     $("#" + numbertype).val(data.NumberType);
                                     $("#" + itemtax).text(data.taxPercent);
                                     $("#" + itemtaxvalue).val(data.taxPercent);
                                     $("#" + design).val(data.DesignCode);
                                     $("#" + designName).val(data.DesignName);
                                     $("#" + brand).val(data.Brand);
                                     $("#" + size).val(data.Size);
                                     $("#" + itemtaxamount).val("0");
                                     $("#discountpercent" + rowid).val(data.discount);
                                     $("#discountrps" + rowid).val(data.discountrps);

                                     window.open("/SalesReturn/PopUpPage?code=" + data.DesignCode + "&item=" + name + "&type=Inventory", "_target", "width=1000,height=200,top=280px,left=200px");

                                     //if new tax arrived e.g. if 5% is there but 12.5% or something else arrived it has to be added as new taxnumber for calculating
                                     //on each item which is applied
                                     var tax = data.taxPercent;
                                     if (tax != '0') {//if tax is '0' no need to add new taxnumber
                                         var taxcount = document.getElementById("ItemTaxCount").value;
                                         if ($("#ItemTaxNumber" + taxcount).val() == 0) { //if first row's tax is 0 then add the tax in taxnumber1
                                             $("#ItemTaxNumber" + taxcount).val(tax);
                                             $("#AddedTax1").text(tax + "%");
                                         }
                                         else {//if first row tax is not 0 then make the taxnumber2 or 3 or more 
                                             var taxpresent = 0;
                                             for (var i = 1; i <= taxcount; i++) {
                                                 var taxno = "ItemTaxNumber" + i;
                                                 //if tax is already present then no need to make other taxnumbers
                                                 if (tax == $("#" + taxno).val()) {
                                                     taxpresent++;
                                                 }
                                             }
                                             if (taxpresent == 0) {
                                                 taxcount++;
                                                 var taxno = "ItemTaxNumber" + taxcount;
                                                 var data = "<input type='hidden' id='" + taxno + "' name='" + taxno + "' value='" + tax + "' />";
                                                 $("#AllTaxesNumbersValue").append(data);
                                                 var addedtaxno = "AddedTax" + taxcount;
                                                 var addedtaxamount = "AddedTaxAmount" + taxcount;
                                                 var addedtaxamounthdn = "AddedTaxAmounthdn" + taxcount;
                                                 var addedamount = "AddedAmount" + taxcount;
                                                 var addedamounthdn = "AddedAmounthdn" + taxcount;
                                                 var newlabel = "<div class='row'><div class='col-md-3 col-lg-3'><label id='" + addedamount + "'>0</label><input type='hidden' id='" + addedamounthdn + "' name='" + addedamounthdn + "' value='0' /></div>";
                                                 newlabel += "<div class='col-md-2 col-lg-2'><label id='" + addedtaxno + "'>" + tax + "%" + "</label></div>";
                                                 newlabel += "<div class='col-md-7 col-lg-7'><label id='" + addedtaxamount + "'>0</label><input type='hidden' id='" + addedtaxamounthdn + "' name='" + addedtaxamounthdn + "' value='0' /></div></div>";
                                                 $("#AddTaxes").append(newlabel);
                                                 $("#ItemTaxCount").val(taxcount);
                                             }
                                         }
                                     }
                                     CalculateRefundOrBalanceAmount();
                                 });
                    }
                    else {
                        $("#itemCode" + rowid).val("").attr("selected", true);
                    }
                }
                else {
                    alertbox("Item Name Already Selected Please change the quantity");
                    if (document.getElementById("quantity" + currentrowid) != null) {
                        document.getElementById("quantity" + currentrowid).disabled = false;
                        document.getElementById("narration" + currentrowid).disabled = false;
                        document.getElementById("rate" + currentrowid).disabled = false;
                        document.getElementById("discountpercent" + currentrowid).disabled = false;
                        document.getElementById("discountrps" + currentrowid).disabled = false;
                    }
                    $("#itemCode" + rowid).val("").attr("selected", true);
                    document.getElementById("quantity" + rowid).value = 0.000;
                    document.getElementById("amount" + rowid).innerHTML = 0.00;
                    if (document.getElementById("proportionatetax" + rowid) != null) {
                        document.getElementById("proportionatetax" + rowid).innerHTML = 0;
                    }
                    $("#narration" + rowid).val("");
                    $("#rate" + rowid).val(0.00);
                    $("#discountrps" + rowid).val(0.00);
                    $("#discountpercent" + rowid).val(0.00);
                    $("#unit" + rowid).text("---");
                    $("#ItemTax" + rowid).text("0");
                    $("#ItemTaxAmt" + rowid).val("0");
                    CalculateItemWiseAmount(rowid, '');
                }
            }
            else {
                alertbox("Please Select Item First");
                $("#itemCode" + rowid).val("").attr("selected", true);
                document.getElementById("quantity" + rowid).value = 0.000;
                document.getElementById("amount" + rowid).innerHTML = 0.00;
                if (document.getElementById("proportionatetax" + rowid) != null) {
                    document.getElementById("proportionatetax" + rowid).innerHTML = 0;
                }
                $("#narration" + rowid).val("");
                $("#rate" + rowid).val(0.00);
                $("#discountrps" + rowid).val(0.00);
                $("#discountpercent" + rowid).val(0.00);
                $("#unit" + rowid).text("---");
                $("#ItemTax" + rowid).text("0");
                $("#ItemTaxAmt" + rowid).val("0");
                CalculateItemWiseAmount(rowid, '');
            }
        });
        $("#hdnRowCount").val(rowid);
    }
</script>

<script type="text/javascript">
    $(function () {
        $("#NonInvButton").click(function () {
            var presentrows = (+document.getElementById("ItemList").value);
            var noninvrowid = (+document.getElementById("hdnRowCount").value);
            var checkboxcount = 0;
            for (i = 1; i <= presentrows; i++) {
                var chkbox = "CheckBox" + i;
                if (!$("#" + chkbox).prop("checked")) {
                    checkboxcount++;
                }
            }
            if (checkboxcount != presentrows) {
                if (noninvrowid > presentrows) {
                    var previtemCode = "itemCode" + noninvrowid;
                    var prevnarration = "narration" + noninvrowid;
                    var prevquantity = "quantity" + noninvrowid;
                    var prevrate = "rate" + noninvrowid;
                    var prevdiscountpercent = "discountpercent" + noninvrowid;
                    var prevdiscountrps = "discountrps" + noninvrowid;
                    if (document.getElementById(previtemCode) != null) {
                        //If Required Fields are Empty of Previous Row
                        if ($("#" + previtemCode).val() == "") {
                            alertbox("Please Select The Item");
                        }
                        else if ($("#" + prevquantity).val() == "" || (+$("#" + prevquantity).val()) == 0) {
                            alertbox("Please Fill The Quantity");
                        }
                        else if ($("#" + prevrate).val() == "" || (+$("#" + prevrate).val()) == 0) {
                            alertbox("Please Fill The Rate");
                        }
                        else {
                            if (document.getElementById(previtemCode).disabled != true) {
                                document.getElementById(previtemCode).disabled = true;
                                document.getElementById(prevnarration).disabled = true;
                                document.getElementById(prevquantity).disabled = true;
                                document.getElementById(prevrate).disabled = true;
                                document.getElementById(prevdiscountpercent).disabled = true;
                                document.getElementById(prevdiscountrps).disabled = true;
                            }
                            GenerateNonInvDynamicRow(noninvrowid, presentrows);
                        }
                    }
                    else {
                        GenerateNonInvDynamicRow(noninvrowid, presentrows);
                    }
                }
                else {
                    GenerateNonInvDynamicRow(noninvrowid, presentrows);
                }
            }
            else { alertbox("Please Select At Least One Item"); }
        });
    });
</script>

<script type="text/javascript">
    function GenerateNonInvDynamicRow(noninvrowid, presentrows) {
        noninvrowid = +noninvrowid + 1;
        var noninvItemType = "ItemType" + noninvrowid;
        var noninvrow = "row" + noninvrowid;
        var noninvitemCode = "itemCode" + noninvrowid;
        var noninvitemName = "itemName" + noninvrowid;
        var noninvbarcode = "Barcode" + noninvrowid;
        var noninvdescription = "description" + noninvrowid;
        var noninvnarration = "narration" + noninvrowid;
        var noninvmaterialvalue = "materialvalue" + noninvrowid;
        var noninvcolor = "color" + noninvrowid;
        var noninvcolorvalue = "colorvalue" + noninvrowid;
        var noninvquantity = "quantity" + noninvrowid;
        var noninvprevquantity = "prevquantity" + noninvrowid;
        var noninvshopqty = "ShopQty" + noninvrowid;
        var noninvrate = "rate" + noninvrowid;
        var noninvmrp = "MRP" + noninvrowid;
        var noninvdiscountpercent = "discountpercent" + noninvrowid;
        var noninvamount = "amount" + noninvrowid;
        var noninvamountvalue = "amountvalue" + noninvrowid;
        var noninvitemtax = "ItemTax" + noninvrowid;
        var noninvitemtaxvalue = "ItemTaxValue" + noninvrowid;
        var noninvitemtaxamount = "ItemTaxAmt" + noninvrowid;
        var noninvunit = "unit" + noninvrowid;
        var noninvunitvalue = "unitvalue" + noninvrowid;
        var noninvnumbertype = "numberType" + noninvrowid;
        var noninvdesign = "design" + noninvrowid;
        var noninvdesignName = "designName" + noninvrowid;
        var noninvbrand = "Brand" + noninvrowid;
        var noninvsize = "Size" + noninvrowid;
        var noninvproportionatetax = "proportionatetax" + noninvrowid;
        var noninvproportionatetaxvalue = "proportionatetaxvalue" + noninvrowid;
        var noninvproportionateamount = "proportionatetaxamount" + noninvrowid;

        var dynamicrow = $("#DynamicRows");
        var data = "<tr id='" + noninvrow + "'>";
        data += "<td style='text-align:center'>---</td>";
        data += "<td>" + noninvrowid + "</td>";
        data += "<td><select id='" + noninvitemCode + "' name='" + noninvitemCode + "' class='form-control col-md-2 col-lg-2'><option value=''>Select</option></select><input type='hidden' id='" + noninvitemName + "' name='" + noninvitemName + "' /><input type='hidden' id='" + noninvbarcode + "' name='" + noninvbarcode + "' /><input type='hidden' id='" + noninvItemType + "' name='" + noninvItemType + "' value='NonInventory'/><input type='hidden' id='" + noninvbrand + "' name='" + noninvbrand + "' /><input type='hidden' id='" + noninvsize + "' name='" + noninvsize + "' /></td>";
        data += "<td><input type='hidden' id='" + noninvdescription + "' name='" + noninvdescription + "' /><input type='text' id='" + noninvnarration + "' name='" + noninvnarration + "' class='form-control col-md-2 col-lg-2' placeholder='Narration' style='text-align:center' /><input type='hidden' id='" + noninvdesignName + "' name='" + noninvdesignName + "' /><input type='hidden' id='" + noninvdesign + "' name='" + noninvdesign + "' /><input type='hidden' id='" + noninvmaterialvalue + "' name='" + noninvmaterialvalue + "' /></td>";
        data += "<td><label id='" + noninvcolor + "' style='text-align:center;font-weight:normal'></label><input type='hidden' id='" + noninvcolorvalue + "' name='" + noninvcolorvalue + "' /></td>";
        data += "<td style='text-align:center'><label id='" + noninvunit + "' style='font-weight:normal'></label><input type='hidden' name='" + noninvunitvalue + "' id='" + noninvunitvalue + "'><input type='hidden' name='" + noninvnumbertype + "' id='" + noninvnumbertype + "'></td>";
        data += "<td style='text-align:center'><label id='" + noninvshopqty + "'>---</label></td>"
        data += "<td style='text-align:center'><label id='" + noninvprevquantity + "'>---</label></td>"
        data += "<td><input type='text' id='" + noninvquantity + "' name='" + noninvquantity + "' autocomplete='off' class='form-control col-md-1 col-lg-1' placeholder='Qty' style='text-align:center;width:100%' onchange='CalculateItemWiseAmount(" + noninvrowid + ',' + '\"\"' + ")' onkeypress='return AllowDecimal(event," + noninvrowid + ")' /></td>";
        data += "<td><input type='text' id='" + noninvrate + "' name='" + noninvrate + "' autocomplete='off' class='form-control col-md-2 col-lg-2' placeholder='Rate' style='text-align:center;width:100%' onchange='CalculateItemWiseAmount(" + noninvrowid + ',' + '\"\"' + ")' onkeypress='return AllowNumbers(event)' /><input type='hidden' id='" + noninvmrp + "' name='" + noninvmrp + "'/></td>";
        data += "<td><input type='text' id='" + noninvdiscountpercent + "' name='" + noninvdiscountpercent + "' autocomplete='off' class='form-control col-md-1 col-lg-1' value='0' placeholder='0%' style='font-weight:normal; text-align:center;width:100%' onchange='CalculateItemWiseAmount(" + noninvrowid + ',' + '\"percent\"' + ")' onkeypress='return AllowNumbers(event)' /></td>";
        data += "<td><input type='text' id='discountrps" + noninvrowid + "' name='discountrps" + noninvrowid + "'  autocomplete='off' class='form-control col-md-1 col-lg-1' value='0.00' placeholder='0' style='font-weight:normal; text-align:center;width:100%' onchange='CalculateItemWiseAmount(" + noninvrowid + ',' + '\"rps\"' + ")' onkeypress='return AllowNumbers(event)' /></td>";
        data += "<td style='text-align:center'><label id='" + noninvitemtax + "' style='font-weight:normal'>0</label><input type='hidden' id='" + noninvitemtaxvalue + "' name='" + noninvitemtaxvalue + "' value='0'/><input type='hidden' id='" + noninvitemtaxamount + "' name='" + noninvitemtaxamount + "' value='0'/></td>";
        data += "<td style='text-align:center'><label id='" + noninvamount + "'style='text-align:right;font-weight:normal'>0</label><input type='hidden' id='" + noninvamountvalue + "' name='" + noninvamountvalue + "' value='0'/></td>";
        var salesbillno = (document.getElementById("BillNo").value).search("SB");
        if (salesbillno == 0) {
            data += "<td style='text-align:right'><label id='" + noninvproportionatetax + "' style='font-weight:normal'>0</label><input type='hidden' id='" + noninvproportionatetaxvalue + "' name='" + noninvproportionatetaxvalue + "' value='0' /><input type='hidden' id='" + noninvproportionateamount + "' name='" + noninvproportionateamount + "' value='0' /></td>";
        }
        data += "<td><div style='height:2px'></div><a href='#' onclick='DeleteRow(" + noninvrowid + ")' class='fa fa-trash fa-lg' style='color:red;' /></td></tr>";
        dynamicrow.append(data);
        var shopcode = document.getElementById("loginshopcode").value;
        $.getJSON("/SalesReturn/GetItemsFromShopStockAndStkDistrbtn", { ItemType: "NonInventory", LoginShop: shopcode },
                function (data) {
                    var select = $("#" + noninvitemCode);
                    select.empty();
                    select.append($('<option/>', {
                        text: "Select Item",
                        value: "",
                    }));
                    $.each(data, function (index, itemdata) {
                        select.append($('<option/>', {
                            text: itemdata.Text + " " + itemdata.Value,
                            value: itemdata.Value,
                        }));
                    });
                });

        $("#" + noninvitemCode).change(function () {
            var name = document.getElementById(noninvitemCode).value;
            if (name != "") {
                // EMPTY STOCK QUANTITY AND QUANTITY BECOZ IF WE CHANGE ITEM PREVIOUS ROWS STOCK QUANTITY AND QUANTITY IS EMPTY
                var qty = "quantity" + noninvrowid;
                var amt = "amount" + noninvrowid;
                //IF ROW IS DELETED THEN QUANTITY WON'T GET ENABLED
                if (document.getElementById(qty) != null) {
                    document.getElementById(qty).value = "";
                    document.getElementById(amt).innerHTML = "";
                }

                //IF PREVIOUS ROW IS ENABLED FOR CHANGE THE QUANTITY BUT WE SELECT AGAIN DDL THEN DISABLED THIS ENABLES QUANTITY
                var validationcount = 0;
                for (var i = presentrows + 1; i < noninvrowid; i++) {
                    var prevquantity = "quantity" + i;
                    var prevrate = "rate" + i;
                    //var prevdesign = "design" + i;
                    if (document.getElementById(prevquantity) != null) {
                        if ((+$("#" + prevquantity).val()) == 0 || $("#" + prevquantity).val() == "") {
                            alertbox("Please Fill The Quantity");
                            validationcount++;
                        }
                        else if ($("#" + prevrate).val() == "" || (+$("#" + prevrate).val()) == 0) {
                            alertbox("Please Fill The Rate");
                            validationcount++;
                        }
                        else {
                            if (document.getElementById(prevquantity).disabled == false) {
                                document.getElementById(prevquantity).disabled = true;
                                document.getElementById("narration" + i).disabled = true;
                                document.getElementById(prevrate).disabled = true;
                                document.getElementById("discountpercent" + i).disabled = true;
                                document.getElementById("discountrps" + i).disabled = true;
                            }
                        }
                    }
                }

                if (validationcount == 0) {
                    $.getJSON("/SalesReturn/GetNonInvItemdetailsByItemCodeforQuot",
                                    {
                                        ItemCode: name,
                                        Type: $("#hdnClientType").val(),
                                        State: $("#hdnClientState").val(),
                                        Formtype: $("#hdnFormType").val(),
                                        ConsumeResell: $("#hdnComsumeResell").val(),
                                        billno: $("#BillNo").val()
                                    },
                             function (data) {
                                 document.getElementById("quantity" + noninvrowid).value = "";
                                 document.getElementById("amount" + noninvrowid).innerHTML = 0.00;
                                 document.getElementById("amountvalue" + noninvrowid).innerHTML = 0.00;
                                 $("#" + noninvitemName).val(data.itemName);
                                 $("#" + noninvdescription).val(data.description);
                                 $("#" + noninvcolor).text(data.colorCode);
                                 $("#" + noninvcolorvalue).val(data.colorCode);
                                 $("#" + noninvunit).text(data.unit);
                                 $("#" + noninvunitvalue).val(data.unit);
                                 $("#" + noninvrate).val(data.sellingprice);
                                 $("#" + noninvmrp).val(data.mrp);
                                 $("#" + noninvmaterialvalue).val(data.typeOfMaterial);
                                 $("#" + noninvitemtax).text(data.taxPercent);
                                 $("#" + noninvitemtaxvalue).val(data.taxPercent);
                                 $("#" + noninvnumbertype).val(data.NumberType);
                                 $("#" + noninvdesignName).val(data.designName);
                                 $("#" + noninvdesign).val(data.designCode);
                                 $("#" + noninvbrand).val(data.brandName);
                                 $("#" + noninvsize).val(data.size);
                                 $("#" + noninvitemtaxamount).val("0");
                                 $("#discountpercent" + noninvrowid).val(data.discount);
                                 $("#discountrps" + noninvrowid).val(data.discountrps);

                                 //if new tax arrived e.g. if 5% is there but 12.5% or something else arrived it has to be added as new taxnumber for calculating
                                 //on each item which is applied
                                 var tax = data.taxPercent;
                                 if (tax != '0') {//if tax is '0' no need to add new taxnumber
                                     var taxcount = document.getElementById("ItemTaxCount").value;
                                     if ($("#ItemTaxNumber" + taxcount).val() == 0) { //if first row's tax is 0 then add the tax in taxnumber1
                                         $("#ItemTaxNumber" + taxcount).val(tax);
                                         $("#AddedTax1").text(tax + "%");
                                     }
                                     else {//if first row tax is not 0 then make the taxnumber2 or 3 or more 
                                         var taxpresent = 0;
                                         for (var i = 1; i <= taxcount; i++) {
                                             var taxno = "ItemTaxNumber" + i;
                                             //if tax is already present then no need to make other taxnumbers
                                             if (tax == $("#" + taxno).val()) {
                                                 taxpresent++;
                                             }
                                         }
                                         if (taxpresent == 0) {
                                             taxcount++;
                                             var taxno = "ItemTaxNumber" + taxcount;
                                             var data = "<input type='hidden' id='" + taxno + "' name='" + taxno + "' value='" + tax + "' />";
                                             $("#AllTaxesNumbersValue").append(data);
                                             var addedtaxno = "AddedTax" + taxcount;
                                             var addedtaxamount = "AddedTaxAmount" + taxcount;
                                             var addedtaxamounthdn = "AddedTaxAmounthdn" + taxcount;
                                             var addedamount = "AddedAmount" + taxcount;
                                             var addedamounthdn = "AddedAmounthdn" + taxcount;
                                             var newlabel = "<div class='row'><div class='col-md-3 col-lg-3'><label id='" + addedamount + "'>0</label><input type='hidden' id='" + addedamounthdn + "' name='" + addedamounthdn + "' value='0' /></div>";
                                             newlabel += "<div class='col-md-2 col-lg-2'><label id='" + addedtaxno + "'>" + tax + "%" + "</label></div>";
                                             newlabel += "<div class='col-md-7 col-lg-7'><label id='" + addedtaxamount + "'>0</label><input type='hidden' id='" + addedtaxamounthdn + "' name='" + addedtaxamounthdn + "' value='0' /></div></div>";
                                             $("#AddTaxes").append(newlabel);
                                             $("#ItemTaxCount").val(taxcount);
                                         }
                                     }
                                 }
                                 CalculateRefundOrBalanceAmount();
                             });
                }
                else {
                    $("#itemCode" + noninvrowid).val("").attr("selected", true);
                }
            }
            else {
                alertbox("Please Select Item First");
                document.getElementById("quantity" + noninvrowid).value = 0.000;
                document.getElementById("amount" + noninvrowid).innerHTML = 0.00;
                if (document.getElementById("proportionatetax" + noninvrowid) != null) {
                    document.getElementById("proportionatetax" + noninvrowid).innerHTML = 0;
                }
                $("#narration" + noninvrowid).val("");
                $("#rate" + noninvrowid).val(0.00);
                $("#discountrps" + noninvrowid).val(0.00)
                $("#discountpercent" + noninvrowid).val(0)
                $("#unit" + noninvrowid).text("---");
                $("#ItemTax" + noninvrowid).text("0");
                $("#ItemTaxAmt" + noninvrowid).text("0");
                CalculateItemWiseAmount(noninvrowid, '');
            }
        });
        $("#hdnRowCount").val(noninvrowid);
    }
</script>

<script type="text/javascript">
    function CalculateItemWiseAmount(count, type) {
        var presentrows = document.getElementById("ItemList").value;
        if (type == "rps") {
            document.getElementById("discountType").value = "rps";
        }
        else if (type == "percent") {
            document.getElementById("discountType").value = "percent"
        }

        var quantity = "quantity" + count;
        var prevquantity = "prevquantity" + count;
        var rate = "rate" + count;
        var mrp = "MRP" + count;
        var amount = "amount" + count;
        var discountpercent = "discountpercent" + count;
        var discountrps = "discountrps" + count;
        var amountvalue = "amountvalue" + count;
        var unit = "unitvalue" + count;
        var itemtax = "ItemTax" + count;
        var itemtaxamt = "ItemTaxAmt" + count;
        var shopqty = "ShopQty" + count;
        var totalamount = 0;
        if (document.getElementById(quantity) != null) {
            var percent = (+document.getElementById(discountpercent).value) / 100;
            var rupees = (+document.getElementById(discountrps).value);
            var roundupqty = (+document.getElementById(quantity).value);
            document.getElementById(quantity).value = roundupqty;
            var calculatedvalue = 0;

            var calculatedmrpfromsellprice = +$("#" + rate).val() * +$("#" + itemtax).html() / 100;
            calculatedmrpfromsellprice = +$("#" + rate).val() + calculatedmrpfromsellprice;
            $("#" + mrp).val(calculatedmrpfromsellprice.toFixed(2));

            if (+$("#" + quantity).val() > +$("#" + shopqty).html()) {
                alertbox("Cannot Exceed Above Shop Quantity");
                document.getElementById(quantity).value = document.getElementById(shopqty).innerHTML;
            }

            if ($("#" + unit).val() == "Dozens") {
                calculatedvalue = ((+document.getElementById(quantity).value) * 12) * (+document.getElementById(rate).value);
            }
            else {
                calculatedvalue = (+document.getElementById(quantity).value) * (+document.getElementById(rate).value);
            }
            var discounttype = document.getElementById("discountType").value;
            if (roundupqty == 0 || (+document.getElementById(rate).value) == 0) {
                document.getElementById(discountrps).value = "0.00";
            }
            else if (discounttype == "percent") {
                if (percent != 0) {
                    var valueafterdiscount = calculatedvalue * percent;
                    document.getElementById(discountrps).value = valueafterdiscount.toFixed(2);
                    calculatedvalue -= valueafterdiscount;

                }
                else { document.getElementById(discountrps).value = "0.00"; }
            }
            else {
                if (rupees != 0) {
                    var valueafterdiscount = rupees / calculatedvalue * 100;
                    document.getElementById(discountpercent).value = valueafterdiscount.toFixed(1);
                    calculatedvalue -= rupees;
                }
                else { document.getElementById(discountpercent).value = 0; }
            }

            document.getElementById(amountvalue).value = calculatedvalue.toFixed(2);
            document.getElementById(amount).innerHTML = addCommas(calculatedvalue.toFixed(2));
            document.getElementById(itemtaxamt).value = (calculatedvalue * (+document.getElementById(itemtax).innerHTML / 100)).toFixed(2);
        }
        var rowid = document.getElementById("hdnRowCount").value;
        for (var i = 1; i <= rowid; i++) {
            var amount = "amount" + i;
            if (document.getElementById(amount) != null) {
                totalamount = (+totalamount) + (+removeCommas(document.getElementById(amount).innerHTML));
            }
        }
        document.getElementById("TotalAmount").innerHTML = "<i class='fa fa-rupee'></i>" + addCommas(totalamount.toFixed(2));
        document.getElementById("SalesReturnDetails_TotalAmount").value = totalamount.toFixed(2);
        CalculateTaxSummary(count);
        var totaltaxamt = 0;
        var TaxCount = (+document.getElementById("ItemTaxCount").value);
        if (+($("#ItemTaxNumber1").val()) != 0) {
            for (var i = 1; i <= TaxCount; i++) {
                var addedtaxamount = "AddedTaxAmount" + i;
                totaltaxamt = totaltaxamt + (+removeCommas(document.getElementById(addedtaxamount).innerHTML));
            }
            document.getElementById("TotalTaxAmount").innerHTML = "<i class='fa fa-rupee'></i>" + addCommas(totaltaxamt.toFixed(2));
            document.getElementById("SalesReturnDetails_TotalTaxAmount").value = totaltaxamt.toFixed(2);
        }
        totalamount += totaltaxamt;
        totalamount = Math.round(totalamount.toFixed(2));
        if (totalamount < 0) {
            document.getElementById("SalesReturnDetails_GrandTotal").value = totalamount.toFixed(2);
            document.getElementById("GrandTotal").innerHTML = "-" + "<i class='fa fa-rupee'></i>" + addCommas(totalamount.toFixed(2));
        }
        else {
            document.getElementById("SalesReturnDetails_GrandTotal").value = totalamount.toFixed(2);
            document.getElementById("GrandTotal").innerHTML = "<i class='fa fa-rupee'></i>" + addCommas(totalamount.toFixed(2));
        }
        CalculateRefundOrBalanceAmount();
        CalculateTotalDiscount();
        CalculateTotalAmount();
    }
</script>

<script type="text/javascript">
    function CalculateRefundAmount(count) {
        count = +count;

        var quantity = "quantity" + count;
        var prevquantity = "prevquantity" + count;
        var rate = "rate" + count;
        var amount = "amount" + count;
        var discountrpslabel = "discountrpslabel" + count;
        var discountpercent = "discountpercent" + count;
        var discountrps = "discountrps" + count;
        var amountvalue = "amountvalue" + count;
        var unit = "unitvalue" + count;
        var itemtax = "ItemTax" + count;
        var itemtaxamt = "ItemTaxAmt" + count;
        var totalamount = 0;
        var percent = (+document.getElementById(discountpercent).value) / 100;
        var rupees = (+document.getElementById(discountrps).value);
        var roundupqty = (+document.getElementById(quantity).value);
        document.getElementById(quantity).value = roundupqty;

        var calculatedvalue = 0;
        if (+$("#" + quantity).val() > +$("#" + prevquantity).html()) {
            alertbox("Cannot Refund More Than Bill Quantity");
            document.getElementById(quantity).value = +document.getElementById(prevquantity).innerHTML;
        }
        if ($("#" + unit).val() == "Dozens") {
            calculatedvalue = ((+document.getElementById(quantity).value) * 12) * (+removeCommas(document.getElementById(rate).value));
        }
        else {
            calculatedvalue = (+document.getElementById(quantity).value) * (+removeCommas(document.getElementById(rate).value));
        }

        if (percent != 0) {
            var valueafterdiscount = calculatedvalue * percent;
            document.getElementById(discountrps).value = valueafterdiscount.toFixed(2);
            document.getElementById(discountrpslabel).innerHTML = addCommas(valueafterdiscount.toFixed(2));
            calculatedvalue -= valueafterdiscount;
        }

        document.getElementById(amountvalue).value = calculatedvalue.toFixed(2);
        document.getElementById(amount).innerHTML = addCommas(calculatedvalue.toFixed(2));
        document.getElementById(itemtaxamt).value = (calculatedvalue * (+document.getElementById(itemtax).innerHTML / 100)).toFixed(2);
        CalculateTaxSummary($("#hdnRowCount").val());
        CalculateRefundOrBalanceAmount();
        CalculateTotalAmount();


        CalculateTaxSummary($("#hdnRowCount").val());
        var presentrows = +document.getElementById("ItemList").value;
        var calctotalamount = 0;
        for (i = 1 ; i <= presentrows; i++) {
            var newitemamount = "amount" + i;
            var newitemtax = "ItemTax" + i;
            var newitemtaxamt = "ItemTaxAmt" + i;
            var newitemproptaxamt = "proportionatetaxamount" + i;
            if ($("#CheckBox" + i).prop("checked")) {
                if (document.getElementById(newitemamount) != null) {
                    calctotalamount = calctotalamount + (+removeCommas(document.getElementById(newitemamount).innerHTML)) + (+removeCommas(document.getElementById(newitemtaxamt).value))
                    if (document.getElementById(newitemproptaxamt) != null) {
                        calctotalamount = calctotalamount + ((+document.getElementById(newitemproptaxamt).value) * (+document.getElementById(newitemtax).innerHTML / 100)) + (+removeCommas(document.getElementById(newitemproptaxamt).value));
                    }
                }
            }

            document.getElementById("RefundableAmountLabel").innerHTML = calctotalamount.toFixed(2);
            document.getElementById("RefundableAmount").value = calctotalamount.toFixed(2);
            document.getElementById("CreditNoteAmount").innerHTML = calctotalamount.toFixed(2);
            document.getElementById("RefundAmount").innerHTML = calctotalamount.toFixed(2);
        }
        CalculateRefundOrBalanceAmount();
        CalculateTotalDiscount();
        CalculateTotalAmount();
    }
</script>

<script type="text/javascript">
    function CalculateRefundOrBalanceAmount() {
        var refundableamt = +removeCommas(document.getElementById("RefundableAmountLabel").innerHTML);
        var presentrows = +document.getElementById("ItemList").value;
        var rowcount = +document.getElementById("hdnRowCount").value;
        var calctotalamount = 0;
        for (i = presentrows + 1; i <= rowcount; i++) {
            var newitemamount = "amount" + i;
            var newitemtax = "ItemTax" + i;
            var newitemtaxamt = "ItemTaxAmt" + i;

            if (document.getElementById(newitemamount) != null) {
                calctotalamount = calctotalamount + (+removeCommas(document.getElementById(newitemamount).innerHTML)) + (+removeCommas(document.getElementById(newitemtaxamt).value))
            }
        }
        var RefundBalAmt = 0;
        RefundBalAmt = refundableamt - calctotalamount;
        RefundBalAmt = Math.round(RefundBalAmt.toFixed(2));
        if (RefundBalAmt == 0) {
            document.getElementById("AmountBalance").innerHTML = 0;
            document.getElementById("AmountBalance").style.color = "red";
            document.getElementById("AmountBalanceValue").value = 0;
            document.getElementById("RefundAmount").innerHTML = 0;
            document.getElementById("RefundAmount").style.color = "green";
            document.getElementById("RefundAmountValue").value = 0;
        }
        else if (RefundBalAmt < 0) {
            document.getElementById("AmountBalance").innerHTML = (0 - RefundBalAmt).toFixed(2);
            document.getElementById("AmountBalance").style.color = "red";
            document.getElementById("AmountBalanceValue").value = (0 - RefundBalAmt).toFixed(2);
            document.getElementById("RefundAmount").innerHTML = 0;
            document.getElementById("RefundAmount").style.color = "green";
            document.getElementById("RefundAmountValue").value = 0;

        }
        else {
            document.getElementById("AmountBalance").innerHTML = 0;
            document.getElementById("AmountBalance").style.color = "red";
            document.getElementById("AmountBalanceValue").value = 0;
            document.getElementById("RefundAmount").innerHTML = RefundBalAmt.toFixed(2);
            document.getElementById("RefundAmount").style.color = "green";
            document.getElementById("RefundAmountValue").value = RefundBalAmt.toFixed(2);
        }
        CalculateTotalAmount();
    }
</script>


<script type="text/javascript">
    function DeleteRow(id) {
        var row = "row" + id;
        confirmbox("Are you sure you wish to delete this row?", row);

    }
</script>
<script type="text/javascript">
    //SELECT ALL CHECKBOXES ON SELECT ALL CHECKBOX BUTTON
    function SelectAllCheckbox() {
        var count = document.getElementById("ItemList").value;
        if ($("#SelectAllId").attr("checked")) {
            for (i = 1; i <= count; i++) {
                var chkbox = "CheckBox" + i;
                $("#" + chkbox).attr("checked", true);
                document.getElementById(chkbox).value = "Yes";
                document.getElementById("quantity" + i).disabled = false;
                AddTheItemTaxNumbar(+$("#ItemTax" + i).html());
            }
            document.getElementById("RefundableAmountLabel").innerHTML = (+removeCommas(document.getElementById("GrandTotal").innerHTML)).toFixed(2);
            document.getElementById("RefundableAmount").value = (+removeCommas(document.getElementById("GrandTotal").innerHTML)).toFixed(2);
            document.getElementById("CreditNoteAmount").innerHTML = (+removeCommas(document.getElementById("GrandTotal").innerHTML)).toFixed(2);
            document.getElementById("RefundAmount").innerHTML = (+removeCommas(document.getElementById("GrandTotal").innerHTML)).toFixed(2);
            document.getElementById("RefundAmountValue").value = document.getElementById("GrandTotal").innerHTML;
            CalculateTaxSummary(+$("#hdnRowCount").val());
            document.getElementById("Save").disabled = false;
            CalculateTotalDiscount();
            CalculateTotalAmount();
        }
        else {
            for (i = 1; i <= count; i++) {
                var chkbox = "CheckBox" + i;
                $("#" + chkbox).attr("checked", false);
                document.getElementById(chkbox).value = "No";
                document.getElementById("quantity" + i).disabled = true;
            }
            document.getElementById("RefundableAmountLabel").innerHTML = 0;
            document.getElementById("RefundableAmount").value = 0;
            document.getElementById("CreditNoteAmount").innerHTML = 0;
            document.getElementById("RefundAmount").innerHTML = 0;
            document.getElementById("RefundAmountValue").value = 0;
            CalculateTaxSummary(+$("#hdnRowCount").val());
            CalculateTotalDiscount();
            CalculateTotalAmount();
            document.getElementById("Save").disabled = true;
        }

    }

    //CALCULATE REFUNDABLE AMOUNT
    function CalculateRefundableAmount(rowid) {

        rowid = +rowid;
        //document.getElementById("verticalline1").style.display = 'inline';
        $("#SelectAllId").attr("checked", false);
        var count = document.getElementById("ItemList").value;
        document.getElementById("Save").disabled = false;
        //when we unselect any item then unselect select all checkbox
        var checkedcount = 0;
        for (i = 1; i <= count; i++) {
            var chkbox = "CheckBox" + i;
            if ($("#" + chkbox).prop("checked")) {
                checkedcount++;
            }
        }

        if (checkedcount == count) {
            $("#SelectAllId").attr("checked", true);
        }

        var chkbox = "CheckBox" + rowid;
        var amount = "amount" + rowid;
        var itemtaxamt = "ItemTaxAmt" + rowid;
        var TotalAmount = 0;
        var amt = +removeCommas(document.getElementById(amount).innerHTML);
        var itemtaxamount = +removeCommas(document.getElementById(itemtaxamt).value);
        var refundamt = +removeCommas(document.getElementById("RefundableAmountLabel").innerHTML);
        var ttlamt = +removeCommas(document.getElementById("TotalAmount").innerHTML);

        CalculateTaxSummary(+$("#hdnRowCount").val());
        if ($("#" + chkbox).prop("checked")) {
            document.getElementById("quantity" + rowid).disabled = false;
            var refundableamt = refundamt + amt + itemtaxamount;
            var newtotalamount = +((+removeCommas(document.getElementById("TotalAmount").innerHTML)) - amt).toFixed(2)
            document.getElementById("TotalAmount").innerHTML = "<i class='fa fa-inr'></i>" + addCommas(newtotalamount.toFixed(2));
            document.getElementById("SalesReturnDetails_TotalAmount").value = newtotalamount.toFixed(3)
            document.getElementById("RefundableAmountLabel").innerHTML = refundableamt.toFixed(2);
            document.getElementById("RefundableAmount").value = refundableamt.toFixed(2);
            document.getElementById("CreditNoteAmount").innerHTML = refundableamt.toFixed(2);
            document.getElementById("RefundAmount").innerHTML = refundableamt.toFixed(2);
            document.getElementById("RefundAmount").style.color = "green";
            document.getElementById("RefundAmountValue").value = refundableamt.toFixed(2);
            var Grandtotal = (+(removeCommas(document.getElementById("TotalAmount").innerHTML)) + (+(removeCommas(document.getElementById("TotalTaxAmount").innerHTML))));
            if (document.getElementById("PackagingAndForwarding") != null) {
                Grandtotal += +(removeCommas(document.getElementById("PackagingAndForwarding").innerHTML))
            }
            document.getElementById("GrandTotal").innerHTML = "<i class='fa fa-inr'></i>" + addCommas(Grandtotal.toFixed(2));
            document.getElementById("SalesReturnDetails_GrandTotal").value = Grandtotal.toFixed(2);
            ////for save the selected chechbox
            document.getElementById(chkbox).value = "Yes";
            AddTheItemTaxNumbar($("#ItemTax" + rowid).html());
            CalculateReturnTaxSummary();
        }
        else {
            document.getElementById("quantity" + rowid).disabled = true;
            var refundableamt = refundamt - amt - itemtaxamount;

            if (refundableamt < 0) {
                refundableamt = 0;
            }
            document.getElementById("quantity" + rowid).value = +document.getElementById("prevquantity" + rowid).innerHTML;
            CalculateRefundAmount(rowid);
            var newtotalamount = +((+removeCommas(document.getElementById("TotalAmount").innerHTML)) + amt).toFixed(2)
            document.getElementById("TotalAmount").innerHTML = "<i class='fa fa-inr'></i>" + addCommas(newtotalamount.toFixed(2));
            document.getElementById("SalesReturnDetails_TotalAmount").value = newtotalamount.toFixed(2);
            document.getElementById("RefundableAmountLabel").innerHTML = refundableamt.toFixed(2);
            document.getElementById("RefundableAmount").value = refundableamt.toFixed(2);
            document.getElementById("CreditNoteAmount").innerHTML = refundableamt.toFixed(2);
            document.getElementById("RefundAmount").innerHTML = refundableamt.toFixed(2);
            document.getElementById("RefundAmount").style.color = "green";
            document.getElementById("RefundAmountValue").value = refundableamt.toFixed(2);
            var Grandtotal = (+(removeCommas(document.getElementById("TotalAmount").innerHTML)) + (+(removeCommas(document.getElementById("TotalTaxAmount").innerHTML))));
            if (document.getElementById("PackagingAndForwarding") != null) {
                Grandtotal += +(removeCommas(document.getElementById("PackagingAndForwarding").innerHTML))
            }
            document.getElementById("GrandTotal").innerHTML = "<i class='fa fa-inr'></i>" + addCommas(Grandtotal.toFixed(2));
            document.getElementById("SalesReturnDetails_GrandTotal").value = Grandtotal.toFixed(2);
            document.getElementById(chkbox).value = "No";
        }
        CalculateRefundOrBalanceAmount();
        CalculateTotalDiscount();
        CalculateTotalAmount();
    }

</script>

<script type="text/javascript">
    function AddTheItemTaxNumbar(tax) {
        if (+tax != 0) {
            var taxcount = document.getElementById("ReturnItemTaxCount").value;
            if ($("#ReturnItemTaxNumber" + taxcount).val() == 0) { //if first row's tax is 0 then add the tax in taxnumber1
                $("#ReturnItemTaxNumber" + taxcount).val(tax);
                //document.getElementById("ReturnAddTaxes").style.display = "inline";
                $("#ReturnAddedTax1").text(tax + "%");
            }
            else {
                var taxpresent = 0;
                for (var i = 1; i <= taxcount; i++) {
                    var taxno = "ReturnItemTaxNumber" + i;
                    if (tax == $("#" + taxno).val()) {
                        taxpresent++;
                    }
                }
                if (taxpresent == 0) {
                    taxcount++;
                    var taxno = "ReturnItemTaxNumber" + taxcount;
                    var data = "<input type='hidden' id='" + taxno + "' name='" + taxno + "' value='" + tax + "' />";
                    $("#ReturnAllTaxesNumbersValue").append(data);
                    var addedtaxno = "ReturnAddedTax" + taxcount;
                    var addedtaxamount = "ReturnAddedTaxAmount" + taxcount;
                    var addedtaxamounthdn = "ReturnAddedTaxAmounthdn" + taxcount;
                    var addedamount = "ReturnAddedAmount" + taxcount;
                    var addedamounthdn = "ReturnAddedAmounthdn" + taxcount;
                    var newlabel = "<div class='row'><div class='col-md-3 col-lg-3'><label id='" + addedamount + "'>0</label><input type='hidden' id='" + addedamounthdn + "' name='" + addedamounthdn + "' value='0' /></div>";
                    newlabel += "<div class='col-md-2 col-lg-2'><label id='" + addedtaxno + "'>" + tax + "%" + "</label></div>";
                    newlabel += "<div class='col-md-7 col-lg-7'><label id='" + addedtaxamount + "'>0</label><input type='hidden' id='" + addedtaxamounthdn + "' name='" + addedtaxamounthdn + "' value='0' /></div></div>";
                    $("#ReturnAddTaxes").append(newlabel);
                    $("#ReturnItemTaxCount").val(taxcount);
                }
            }
        }
    }

    function CalculateReturnTaxSummary() {
        var rowid = +document.getElementById("ItemList").value;
        var TaxCount = +document.getElementById("ReturnItemTaxCount").value;

        for (var i = 1; i <= TaxCount; i++) {
            var TotalTaxAmount = 0;
            var itemtaxno = "ReturnItemTaxNumber" + i;
            var addedtaxamount = "ReturnAddedTaxAmount" + i;
            var addedtaxamounthdn = "ReturnAddedTaxAmounthdn" + i;
            var addedamount = "ReturnAddedAmount" + i;
            var addedamounthdn = "ReturnAddedAmounthdn" + i;
            for (var j = 1; j <= rowid; j++) {
                var checkbox = "CheckBox" + j;
                var itemtax = "ItemTax" + j;
                var amount = "amount" + j;
                if ($("#" + checkbox).prop("checked")) {
                    if ($("#" + itemtaxno).val() == $("#" + itemtax).html()) {
                        TotalTaxAmount = (+TotalTaxAmount) + (+removeCommas(document.getElementById(amount).innerHTML));
                    }
                }
            }
            document.getElementById(addedamount).innerHTML = "<i class='fa fa-inr'></i>" + addCommas(TotalTaxAmount.toFixed(2));
            document.getElementById(addedamounthdn).value = TotalTaxAmount.toFixed(2);
            TotalTaxAmount = TotalTaxAmount * (+document.getElementById(itemtaxno).value / 100);
            document.getElementById(addedtaxamount).innerHTML = "<i class='fa fa-inr'></i>" + addCommas(TotalTaxAmount.toFixed(2));
            document.getElementById(addedtaxamounthdn).value = TotalTaxAmount.toFixed(2);
        }
    }
</script>

<script type="text/javascript">
    function CalculateTaxSummary(rowid) {
        var ActualTotalAmount = 0;
        var presentrows = +document.getElementById("ItemList").value;
        var rowid = +document.getElementById("hdnRowCount").value;

        var TaxCount = document.getElementById("ItemTaxCount").value;
        for (var i = 1; i <= TaxCount; i++) {
            var TotalTaxAmount = 0;
            var itemtaxno = "ItemTaxNumber" + i;
            var addedtaxamount = "AddedTaxAmount" + i;
            var addedtaxamounthdn = "AddedTaxAmounthdn" + i;
            var addedamount = "AddedAmount" + i;
            var addedamounthdn = "AddedAmounthdn" + i;
            for (var j = 1; j <= rowid; j++) {
                var chechbox = "CheckBox" + j;
                var itemtaxvalue = "ItemTaxValue" + j;
                var amount = "amount" + j;
                var quantity = "quantity" + j;
                var discountpercent = "discountpercent" + i;
                var prevquantity = "prevquantity" + j;
                var rate = "ratelabel" + j;
                if (document.getElementById(amount) != null) {
                    var itemamount = (+removeCommas(document.getElementById(amount).innerHTML));
                    if (document.getElementById(chechbox) != null) {
                        if ($("#" + chechbox).prop("checked")) {
                            if ((+$("#" + prevquantity).html() - (+$("#" + quantity).val())) != 0) {
                                itemamount = (+$("#" + prevquantity).html()) * (+removeCommas(document.getElementById(rate).innerHTML));
                                itemamount = itemamount - (itemamount * (document.getElementById(discountpercent).value) / 100);
                            }
                        }
                    }
                    if ($("#" + itemtaxno).val() == $("#" + itemtaxvalue).val()) {
                        TotalTaxAmount = (+TotalTaxAmount) + itemamount;
                    }
                }
            }
            document.getElementById(addedamount).innerHTML = "<i class='fa fa-inr'></i>" + addCommas(TotalTaxAmount.toFixed(2));
            document.getElementById(addedamounthdn).value = TotalTaxAmount.toFixed(2);
            TotalTaxAmount = TotalTaxAmount * (+document.getElementById(itemtaxno).value / 100);
            document.getElementById(addedtaxamount).innerHTML = "<i class='fa fa-inr'></i>" + addCommas(TotalTaxAmount.toFixed(2));
            document.getElementById(addedtaxamounthdn).value = TotalTaxAmount.toFixed(2);
        }

        var itemlist = document.getElementById("ItemList").value;
        for (i = 1; i <= itemlist; i++) {
            var checkbox = "CheckBox" + i;
            if ($("#" + checkbox).prop("checked")) {
                for (var j = 1; j <= TaxCount; j++) {
                    var TotalTaxAmount = 0;
                    var itemtaxno = "ItemTaxNumber" + j;
                    var addedtaxamount = "AddedTaxAmount" + j;
                    var addedtaxamounthdn = "AddedTaxAmounthdn" + j;
                    var addedamount = "AddedAmount" + j;
                    var addedamounthdn = "AddedAmounthdn" + j;

                    var amount = +removeCommas(document.getElementById("amount" + i).innerHTML);
                    var itemtax = +removeCommas(document.getElementById("ItemTax" + i).innerHTML);
                    var itemtaxamt = +removeCommas(document.getElementById("ItemTaxAmt" + i).innerHTML);

                    if ((+$("#" + itemtaxno).val()) == itemtax) {
                        tax = (amount * (+$("#" + itemtaxno).val())) / 100;
                        document.getElementById(addedamount).innerHTML = "<i class='fa fa-inr'></i>" + addCommas(((+removeCommas(document.getElementById(addedamount).innerHTML)) - amount).toFixed(2));
                        document.getElementById(addedamounthdn).value = ((+removeCommas(document.getElementById(addedamounthdn).value)) - amount).toFixed(2);
                        document.getElementById(addedtaxamount).innerHTML = "<i class='fa fa-inr'></i>" + addCommas(((+removeCommas(document.getElementById(addedtaxamount).innerHTML)) - tax).toFixed(2));
                        document.getElementById(addedtaxamounthdn).value = ((+removeCommas(document.getElementById(addedtaxamounthdn).value)) - tax).toFixed(2);
                    }
                }
            }
        }

        var TotalTaxAmount = 0;
        for (i = 1; i <= TaxCount; i++) {
            var addedamounthdn = "AddedTaxAmounthdn" + i;
            TotalTaxAmount = TotalTaxAmount + (+document.getElementById(addedamounthdn).value);
        }
        document.getElementById("TotalTaxAmount").innerHTML = "<i class='fa fa-inr'></i>" + TotalTaxAmount.toFixed(2);
        document.getElementById("SalesReturnDetails_TotalTaxAmount").value = TotalTaxAmount.toFixed(2);
    }
</script>

<script type="text/javascript">
    function CalculateTotalAmount() {
        var presentrows = +document.getElementById("ItemList").value;
        var rowid = +document.getElementById("hdnRowCount").value;
        var totalamount = 0;

        for (i = 1; i <= presentrows; i++) {
            var checkbox = "CheckBox" + i;
            var amount = "amount" + i;
            if (!$("#" + checkbox).prop("checked")) {
                totalamount = totalamount + (+removeCommas(document.getElementById(amount).innerHTML));
            }
        }

        for (i = 1; i <= presentrows; i++) {
            var checkbox = "CheckBox" + i;
            var amount = "amount" + i;
            var prevquantity = "prevquantity" + i;
            var quantity = "quantity" + i;
            var discountpercent = "discountpercent" + i;
            var rate = "rate" + i;
            if ($("#" + checkbox).prop("checked")) {
                totalamount = totalamount + (((+document.getElementById(prevquantity).innerHTML) - (+document.getElementById(quantity).value)) * (+removeCommas(document.getElementById(rate).value))) - ((((+document.getElementById(prevquantity).innerHTML) - (+document.getElementById(quantity).value)) * (+removeCommas(document.getElementById(rate).value))) * (+document.getElementById(discountpercent).value) / 100);
            }
        }

        for (i = presentrows + 1; i <= rowid; i++) {
            var amount = "amount" + i;
            if (document.getElementById(amount) != null) {
                totalamount = totalamount + (+removeCommas(document.getElementById(amount).innerHTML));
            }
        }

        if (totalamount < 0) {
            totalamount = 0;
        }

        document.getElementById("TotalAmount").innerHTML = "<i class='fa fa-inr'></i>" + addCommas(totalamount.toFixed(2));
        document.getElementById("SalesReturnDetails_TotalAmount").value = totalamount.toFixed(2);

        var TotalTaxAmount = 0;
        var TaxCount = (+document.getElementById("ItemTaxCount").value);
        for (i = 1; i <= TaxCount; i++) {
            var addedamounthdn = "AddedTaxAmounthdn" + i;
            TotalTaxAmount = TotalTaxAmount + (+document.getElementById(addedamounthdn).value);
        }

        document.getElementById("TotalTaxAmount").innerHTML = "<i class='fa fa-inr'></i>" + addCommas(TotalTaxAmount.toFixed(2));
        document.getElementById("SalesReturnDetails_TotalTaxAmount").value = TotalTaxAmount.toFixed(2);
        if (document.getElementById("PackAndForwd") != null) {
            totalamount = totalamount + (+document.getElementById("PackAndForwd").value);
        }
        totalamount = Math.round((totalamount + TotalTaxAmount).toFixed(2));
        document.getElementById("GrandTotal").innerHTML = "<i class='fa fa-inr'></i>" + addCommas(totalamount.toFixed(2));
        document.getElementById("SalesReturnDetails_GrandTotal").value = totalamount.toFixed(2);
        CalculateReturnTaxSummary();
    }
</script>

<script type="text/javascript">
    function CalculateTotalDiscount() {
        var presentrows = +document.getElementById("ItemList").value;
        var totalrows = +document.getElementById("hdnRowCount").value;
        var TotalDiscount = 0;

        for (i = 1; i <= presentrows; i++) {
            var discountpercent = "discountpercent" + i;
            var discountrps = "discountrps" + i;
            var prevquantity = "prevquantity" + i;
            var quantity = "quantity" + i;
            var rate = "rate" + i;
            var checkbox = "CheckBox" + i;

            if ($("#" + checkbox).prop("checked")) {
                remainingdiscount = ((+$("#" + prevquantity).html() - +$("#" + quantity).val()) * +$("#" + rate).val()) * +$("#" + discountpercent).val() / 100;
                TotalDiscount = TotalDiscount + remainingdiscount;
            }
            else {
                TotalDiscount = TotalDiscount + +$("#" + discountrps).val();
            }
        }

        for (i = presentrows + 1; i <= totalrows; i++) {
            var discountrps = "discountrps" + i;
            if (document.getElementById(discountrps) != null) {
                TotalDiscount = TotalDiscount + +$("#" + discountrps).val();
            }
        }

        document.getElementById("TotalDiscountValue").innerHTML = "<i class='fa fa-inr'></i>" + addCommas(TotalDiscount.toFixed(2));
        document.getElementById("SalesReturnDetails_TotalDiscount").value = TotalDiscount.toFixed(2);
    }
</script>

<script type="text/javascript">
    function CalculatePackAndForwd() {
        CalculateTotalAmount();
    }
</script>

<script type="text/javascript">
    function CalculateNewItemGrandTotal() {
        var presentrows = +document.getElementById("ItemList").value;
        var totalrows = +document.getElementById("hdnRowCount").value;
        var TaxCount = document.getElementById("ItemTaxCount").value;
        var totalamount = 0;
        var totaltax = 0;
        var totalgrandtotal = 0;
        var TotalDiscount = 0;
        for (i = presentrows + 1; i <= totalrows; i++) {
            var amount = "amount" + i;
            var discountrps = "discountrps" + i;
            if (document.getElementById(amount) != null) {
                totalamount = totalamount + (+removeCommas(document.getElementById(amount).innerHTML));
                TotalDiscount = TotalDiscount + +$("#" + discountrps).val();
            }
        }
        for (var j = presentrows + 1; j <= totalrows; j++) {
            var itemtax = "ItemTaxValue" + j;
            if (document.getElementById(itemtax) != null) {
                var tax = +document.getElementById(itemtax).value;
                if (tax != 0) {//if tax is '0' no need to add new taxnumber
                    var taxcount = document.getElementById("NewItemTaxCount").value;
                    if ($("#NewItemTaxNumber" + taxcount).val() == 0) { //if first row's tax is 0 then add the tax in taxnumber1
                        $("#NewItemTaxNumber" + taxcount).val(tax);
                    }
                    else {//if first row tax is not 0 then make the taxnumber2 or 3 or more 
                        var taxpresent = 0;
                        for (var i = 1; i <= taxcount; i++) {
                            var taxno = "NewItemTaxNumber" + i;
                            //if tax is already present then no need to make other taxnumbers
                            if (tax == $("#" + taxno).val()) {
                                taxpresent++;
                            }
                        }
                        if (taxpresent == 0) {
                            taxcount++;
                            var taxno = "NewItemTaxNumber" + taxcount;
                            var data = "<input type='hidden' id='" + taxno + "' name='" + taxno + "' value='" + tax + "' />";
                            $("#NewItemAllTaxesNumbersValue").append(data);
                            var addedtaxamounthdn = "NewAddedTaxAmounthdn" + taxcount;
                            var addedamounthdn = "NewAddedAmounthdn" + taxcount;
                            var newhiddenvar = "<input type='hidden' id='" + addedamounthdn + "' name='" + addedamounthdn + "' value='0' /><input type='hidden' id='" + addedtaxamounthdn + "' name='" + addedtaxamounthdn + "' value='0' /></div>";
                            $("#NewItemAllTaxesNumbersValue").append(newhiddenvar);
                            $("#NewItemTaxCount").val(taxcount);
                        }
                    }
                }
            }
        }
        var NewItemTaxCount = document.getElementById("NewItemTaxCount").value;
        for (var i = 1; i <= NewItemTaxCount; i++) {
            var TotalTaxAmount = 0;
            var itemtaxno = "NewItemTaxNumber" + i;
            var addedtaxamounthdn = "NewAddedTaxAmounthdn" + i;
            var addedamounthdn = "NewAddedAmounthdn" + i;
            for (var j = presentrows + 1; j <= totalrows; j++) {
                var itemtaxvalue = "ItemTaxValue" + j;
                var amount = "amount" + j;
                var proportionateamount = "proportionatetaxamount" + j;
                if (document.getElementById(amount) != null) {
                    if ($("#" + itemtaxno).val() == $("#" + itemtaxvalue).val()) {
                        if (document.getElementById(proportionateamount) == null) {
                            TotalTaxAmount = (+TotalTaxAmount) + (+removeCommas(document.getElementById(amount).innerHTML));
                        }
                        else {
                            TotalTaxAmount = (+TotalTaxAmount) + (+removeCommas(document.getElementById(amount).innerHTML)) + (+document.getElementById(proportionateamount).value);
                        }
                    }
                }
            }
            document.getElementById(addedamounthdn).value = TotalTaxAmount.toFixed(2);
            TotalTaxAmount = TotalTaxAmount * (+document.getElementById(itemtaxno).value / 100);
            document.getElementById(addedtaxamounthdn).value = TotalTaxAmount.toFixed(2);
            totaltax = totaltax + TotalTaxAmount;
        }
        totalgrandtotal = totalamount + totaltax;
        totalgrandtotal = Math.round(totalgrandtotal);
        document.getElementById("NewItemTotalAmount").value = totalamount.toFixed(2);
        document.getElementById("NewItemTotalTaxAmount").value = totaltax.toFixed(2);
        document.getElementById("NewItemGrandAmount").value = totalgrandtotal.toFixed(2);
        document.getElementById("NewItemTotalDiscount").value = TotalDiscount.toFixed(2);
    }
</script>
<script type="text/javascript">
    function GetShopQuantity(rowid, itemcode) {
        var shopcode = document.getElementById("loginshopcode").value;
        var shopqty = "ShopQty" + rowid;
        $.getJSON("/SalesReturn/GetShopQty", { itemcode: itemcode, shopcode: shopcode },
            function (data) {
                document.getElementById(shopqty).innerHTML = data;
            });
    }
</script>
<input type="hidden" id="discountType" value="percent" />
<input type="hidden" id="NewItemTotalAmount" name="NewItemTotalAmount" value="0" />
<input type="hidden" id="NewItemTotalTaxAmount" name="NewItemTotalTaxAmount" value="0" />
<input type="hidden" id="NewItemGrandAmount" name="NewItemGrandAmount" value="0" />
<input type="hidden" id="NewItemTotalDiscount" name="NewItemTotalDiscount" value="0" />
<div id="ReturnAllTaxesNumbersValue">
    <input type="hidden" id="ReturnItemTaxCount" name="ReturnItemTaxCount" value="1" />
    <input type="hidden" id="ReturnItemTaxNumber1" name="ReturnItemTaxNumber1" value="0" />
</div>
<div id="AllTaxesNumbersValue">
    @if (Model.InventoryTaxList.Count() == 0)
    {
        <input type="hidden" id="ItemTaxCount" name="ItemTaxCount" value="1" />
        <input type="hidden" id="ItemTaxNumber1" name="ItemTaxNumber1" value="0" />
    }
    else
    {
        <input type="hidden" id="ItemTaxCount" name="ItemTaxCount" value="@Model.InventoryTaxList.Count()" />
        
    }
</div>
<div id="NewItemAllTaxesNumbersValue">
    <input type="hidden" id="NewItemTaxCount" name="NewItemTaxCount" value="1" />
    <input type="hidden" id="NewItemTaxNumber1" name="NewItemTaxNumber1" value="0" />
    <input type="hidden" id="NewAddedAmounthdn1" name="NewAddedAmounthdn1" value="0" />
    <input type="hidden" id="NewAddedTaxAmounthdn1" name="NewAddedTaxAmounthdn1" value="0" />
</div>
<table style="border: 1px double; width: 100%">
    <tr>
        <td>
            <div class="col-md-12 col-lg-12">
                <table class="table">
                    @{
                        // IF SALES ORDER IS SELECTED
                        if (Model.SalesBillDetails != null)
                        {
                            string row = string.Empty;
                            string checkbox = string.Empty;
                            string itemcode = string.Empty;
                            string amount = string.Empty;
                            string amountvalue = string.Empty;
                            string ratevalue = string.Empty;
                            string mrp = string.Empty;
                            string unitvalue = string.Empty;
                            string numbertype = string.Empty;
                            string itemtax = string.Empty;
                            string quantity = string.Empty;
                            string prevquantity = string.Empty;
                            string prevquantityvalue = string.Empty;
                            string shopqty = string.Empty;
                            string itemtaxvalue = string.Empty;
                            string itemtaxamount = string.Empty;
                            string discountpercent = string.Empty;
                            string discountrps = string.Empty;
                            string proptax = string.Empty;
                            string proptaxvalue = string.Empty;
                            string proptaxamount = string.Empty;

                            string itemnamelabel = string.Empty;
                            string narrationlabel = string.Empty;
                            string colorlabel = string.Empty;
                            string ratelabel = string.Empty;
                            string unitlabel = string.Empty;
                            string discountpercentlabel = string.Empty;
                            string discountrpslabel = string.Empty;
                            int rowid = 1;
                        <tr>
                            <th style="text-align: center">SelectAll<br />
                                <input type="checkbox" id="SelectAllId" onclick="SelectAllCheckbox()" />
                            </th>
                            <th>S.N.</th>
                            <th>Item</th>
                            <th>Narration</th>
                            <th>Color</th>
                            <th>Unit</th>
                            <th>Shop Qty</th>
                            <th style="text-align: center">Bill Qty</th>
                            <th style="text-align: center" class="col-md-1 col-lg-1">Return<br />
                                Qty<i style="color: red">*</i></th>
                            <th style="text-align: center">Rate</th>
                            <th style="text-align: center">Disc<br />
                                (%)</th>
                            <th style="text-align: center">Disc<br />
                                (<i class="fa fa-inr"></i>)</th>
                            <th style="text-align: center">Tax<br />
                                (%)</th>
                            <th style="text-align: center">Amt<br />
                                (<i class="fa fa-inr"></i>)</th>
                            <th style="text-align: center">PropTax<br />
                                (%)</th>
                            <th></th>
                        </tr>

                        <tbody id="DynamicRows">
                            @foreach (var item in Model.SalesBillItemList)
                            {
                                row = "Row" + rowid;
                                checkbox = "CheckBox" + rowid;
                                itemcode = "itemCode" + rowid;
                                amount = "amount" + rowid;
                                amountvalue = "amountvalue" + rowid;
                                unitvalue = "unitvalue" + rowid;
                                numbertype = "numberType" + rowid;
                                ratevalue = "rate" + rowid;
                                mrp = "MRP" + rowid;
                                quantity = "quantity" + rowid;
                                prevquantity = "prevquantity" + rowid;
                                prevquantityvalue = "prevquantityvalue" + rowid;
                                shopqty = "ShopQty" + rowid;
                                itemtax = "ItemTax" + rowid;
                                itemtaxvalue = "ItemTaxValue" + rowid;
                                itemtaxamount = "ItemTaxAmt" + rowid;
                                discountpercent = "discountpercent" + rowid;
                                discountrps = "discountrps" + rowid;
                                proptax = "proportionatetax" + rowid;
                                proptaxvalue = "proportionatetaxvalue" + rowid;
                                proptaxamount = "proportionatetaxamount" + rowid;

                                itemnamelabel = "itemnamelabel" + rowid;
                                narrationlabel = "narrationlabel" + rowid;
                                colorlabel = "colorlabel" + rowid;
                                ratelabel = "ratelabel" + rowid;
                                unitlabel = "unitlabel" + rowid;
                                discountpercentlabel = "discountpercentlabel" + rowid;
                                discountrpslabel = "discountrpslabel" + rowid;
                                
                                <tr id="@row">
                                    @{
                                
                                double Rate = Convert.ToDouble(@item.SellingPrice);
                                var rate = Rate.ToString("#,###.00##");
                                double disrs = Convert.ToDouble(@item.DiscountRPS);
                                var DisRs = disrs.ToString("#,###.00##");
                                double Amt = Convert.ToDouble(@item.Amount);
                                var amt = Amt.ToString("#,###.00##");
                                    }
                                    <td style="text-align: center">
                                        <input type="checkbox" id="@checkbox" name="@checkbox" onchange="CalculateRefundableAmount(@rowid)"/></td>
                                    <td>@rowid</td>
                                    <td>
                                        <label id="@itemnamelabel" style="font-weight:normal">@item.ItemName</label>
                                        <input type="hidden" id="@itemcode" name="@itemcode" value="@item.ItemCode" />
                                    </td>
                                    <td>
                                        <label id="@narrationlabel" style="font-weight:normal">@item.Narration</label></td>
                                    <td>
                                        <label id="@colorlabel" style="font-weight:normal">@item.Color</label></td>
                                    <td>
                                        <label id="@unitlabel" style="font-weight:normal">@item.Unit</label>
                                        <input type="hidden" id="@unitvalue" name="@unitvalue" value="@item.Unit" />
                                        <input type="hidden" id="@numbertype" name="@numbertype" value="@item.NumberType" />
                                    </td>
                                    <td style="text-align: center">
                                        @{
                                if (item.ItemType == "Inventory")
                                {
                                            <label id="@shopqty"></label>
                                            <script type="text/javascript">
                                                GetShopQuantity("@rowid", "@item.ItemCode");
                                            </script>
                                }
                                else
                                {
                                            <label id="@shopqty">---</label>
                                }
                                        }
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@prevquantity">@item.Quantity </label>
                                        <input type="hidden" id="@prevquantityvalue" name="@prevquantityvalue" style="text-align:center" class="form-control" value="@item.Quantity" />
                                    </td>
                                    <td>
                                        <input type="text" style="text-align:center" id="@quantity" name="@quantity" autocomplete="off" disabled="disabled" onchange="CalculateRefundAmount(@rowid,'')" onkeypress="return AllowDecimal(event,@rowid)" class="form-control" value="@item.Quantity" />
                                        <script type="text/javascript">
                                            CalculateRefundAmount("@rowid", '');
                                        </script>
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@ratelabel" style="font-weight:normal">@rate</label>
                                        <input type="hidden" id="@ratevalue" name="@ratevalue" value="@item.SellingPrice" />
                                        <input type="hidden" id="@mrp" name="@mrp" value="@item.MRP" />
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@discountpercentlabel" style="font-weight:normal">@item.DiscountPercent</label>
                                        <input type="hidden" id="@discountpercent" name="@discountpercent"  style="text-align:center" class="form-control" value="@item.DiscountPercent" />
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@discountrpslabel" style="font-weight:normal">@DisRs</label>
                                        <input type="hidden" id="@discountrps" name="@discountrps" style="text-align:center" class="form-control" value="@item.DiscountRPS" />
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@itemtax" style="font-weight:normal">@item.ItemTax</label>
                                        <input type="hidden" id="@itemtaxvalue" name="@itemtaxvalue" value="@item.ItemTax" />
                                        <input type="hidden" id="@itemtaxamount" name="@itemtaxamount" value="@item.ItemTaxAmt" /></td>
                                    <td style="text-align: center">
                                        <label id="@amount" style="font-weight:normal">@amt</label>
                                        <input type="hidden" id="@amountvalue" name="@amountvalue"  style="text-align:center" class="form-control" value="@item.Amount" />
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@proptax" style="font-weight:normal">0</label><input type="hidden" id="@proptaxvalue" name="@proptaxvalue" value="0" /><input type="hidden" id="@proptaxamount" name="@proptaxamount" value="0" /></td>
                                    <td></td>
                                </tr>

                                rowid = rowid + 1;
                            }
                            @{
                            rowid = Model.SalesBillItemList.Count() + 1;
                            }
                            @if (Model.SalesBillCreditNoteItemList != null && Model.SalesBillCreditNoteItemList.Any())
                            {
                                foreach (var item in Model.SalesBillCreditNoteItemList)
                                {
                                    row = "Row" + rowid;
                                    checkbox = "CheckBox" + rowid;
                                    itemcode = "itemCode" + rowid;
                                    amount = "amount" + rowid;
                                    amountvalue = "amountvalue" + rowid;
                                    unitvalue = "unitvalue" + rowid;
                                    numbertype = "numberType" + rowid;
                                    ratevalue = "rate" + rowid;
                                    mrp = "MRP" + rowid;
                                    quantity = "quantity" + rowid;
                                    prevquantity = "prevquantity" + rowid;
                                    prevquantityvalue = "prevquantityvalue" + rowid;
                                    shopqty = "ShopQty" + rowid;
                                    itemtax = "ItemTax" + rowid;
                                    itemtaxvalue = "ItemTaxValue" + rowid;
                                    itemtaxamount = "ItemTaxAmt" + rowid;
                                    discountpercent = "discountpercent" + rowid;
                                    discountrps = "discountrps" + rowid;
                                    proptax = "proportionatetax" + rowid;
                                    proptaxvalue = "proportionatetaxvalue" + rowid;
                                    proptaxamount = "proportionatetaxamount" + rowid;

                                    itemnamelabel = "itemnamelabel" + rowid;
                                    narrationlabel = "narrationlabel" + rowid;
                                    colorlabel = "colorlabel" + rowid;
                                    ratelabel = "ratelabel" + rowid;
                                    unitlabel = "unitlabel" + rowid;
                                    discountpercentlabel = "discountpercentlabel" + rowid;
                                    discountrpslabel = "discountrpslabel" + rowid;
                                <tr id="@row">
                                    @{
                                
                                    double Rate = Convert.ToDouble(@item.SellingPrice);
                                    var rate = Rate.ToString("#,###.00##");
                                    double disrs = Convert.ToDouble(@item.DiscRs);
                                    var DisRs = disrs.ToString("#,###.00##");
                                    double Amt = Convert.ToDouble(@item.Amount);
                                    var amt = Amt.ToString("#,###.00##");
                                    }
                                    <td style="text-align: center">
                                        <input type="checkbox" id="@checkbox" name="@checkbox" onchange="CalculateRefundableAmount(@rowid)"/></td>
                                    <td>@rowid</td>
                                    <td>
                                        <label id="@itemnamelabel" style="font-weight:normal">@item.ItemName</label>
                                        <input type="hidden" id="@itemcode" name="@itemcode" value="@item.ItemCode" />
                                    </td>
                                    <td>
                                        <label id="@narrationlabel" style="font-weight:normal">@item.Narration</label></td>
                                    <td>
                                        <label id="@colorlabel" style="font-weight:normal">@item.Color</label></td>
                                    <td>
                                        <label id="@unitlabel" style="font-weight:normal">@item.Unit</label>
                                        <input type="hidden" id="@unitvalue" value="@item.Unit" />
                                        <input type="hidden" id="@numbertype" value="@item.NumberType" />
                                    </td>
                                    <td style="text-align: center">
                                        @{
                                    if (item.ItemType == "Inventory")
                                    {
                                            <label id="@shopqty"></label>
                                            <script type="text/javascript">
                                                GetShopQuantity("@rowid", "@item.ItemCode");
                                            </script>
                                    }
                                    else
                                    {
                                            <label id="@shopqty">---</label>
                                    }
                                        }
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@prevquantity">@item.Balance</label>
                                        <input type="hidden" id="@prevquantityvalue" name="@prevquantityvalue" style="text-align:center" class="form-control" value="@item.Balance" />
                                    </td>
                                    <td>
                                        <input type="text" style="text-align:center" id="@quantity" name="@quantity" autocomplete="off" disabled="disabled" onchange="CalculateRefundAmount(@rowid,'')" onkeypress="return AllowDecimal(event,@rowid)" class="form-control" value="@item.Balance" />
                                        <script type="text/javascript">
                                            CalculateRefundAmount("@rowid", '');
                                        </script>
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@ratelabel" style="font-weight:normal">@rate</label>
                                        <input type="hidden" id="@ratevalue" name="@ratevalue" value="@item.SellingPrice" />
                                        <input type="hidden" id="@mrp" name="@mrp" value="@item.MRP" />
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@discountpercentlabel" style="font-weight:normal">@item.DiscPer</label>
                                        <input type="hidden" id="@discountpercent" name="@discountpercent"  style="text-align:center" class="form-control" value="@item.DiscPer" />
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@discountrpslabel" style="font-weight:normal">@DisRs</label>
                                        <input type="hidden" id="@discountrps" name="@discountrps" style="text-align:center" class="form-control" value="@item.DiscRs" />
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@itemtax" style="font-weight:normal">@item.ItemTax</label>
                                        <input type="hidden" id="@itemtaxvalue" name="@itemtaxvalue" value="@item.ItemTax" />
                                        <input type="hidden" id="@itemtaxamount" name="@itemtaxamount" value="@item.ItemTaxAmt" /></td>
                                    <td style="text-align: center">
                                        <label id="@amount" style="font-weight:normal">@amt</label>
                                        <input type="hidden" id="@amountvalue" name="@amountvalue"  style="text-align:center" class="form-control" value="@item.Amount" />
                                    </td>
                                    <td style="text-align: right">
                                        <label id="@proptax" style="font-weight:normal">0</label>
                                        <input type="hidden" id="@proptaxvalue" name="@proptaxvalue" value="0" />
                                        <input type="hidden" id="@proptaxamount" name="@proptaxamount" value="0" /></td>
                                    <td></td>
                                </tr>

                                    rowid = rowid + 1;
                                }
                            }
                        </tbody>
                            long ItemList = @Model.SalesBillItemList.Count() + @Model.SalesBillCreditNoteItemList.Count();
                            
                        <input type="hidden" id="ItemList" value="@ItemList" name="ItemList"/>
                        <input type="hidden" id="hdnRowCount" name="hdnRowCount" value="@ItemList" />
                        }
                        else
                        {
                            string row = string.Empty;
                            string checkbox = string.Empty;
                            string itemcode = string.Empty;
                            string amount = string.Empty;
                            string amountvalue = string.Empty;
                            string unitvalue = string.Empty;
                            string numbertype = string.Empty;
                            string ratevalue = string.Empty;
                            string mrp = string.Empty;
                            string quantity = string.Empty;
                            string prevquantity = string.Empty;
                            string prevquantityvalue = string.Empty;
                            string shopqty = string.Empty;
                            string discountpercent = string.Empty;
                            string discountrps = string.Empty;
                            string itemtax = string.Empty;
                            string itemtaxvalue = string.Empty;
                            string itemtaxamount = string.Empty;

                            string itemnamelabel = string.Empty;
                            string narrationlabel = string.Empty;
                            string colorlabel = string.Empty;
                            string ratelabel = string.Empty;
                            string unitlabel = string.Empty;
                            string discountpercentlabel = string.Empty;
                            string discountrpslabel = string.Empty;
                            int rowid = 1;
                       
                        <tr>
                            <th style="text-align: center">SelectAll<br />
                                <input type="checkbox" id="SelectAllId" onclick="SelectAllCheckbox()" />
                            </th>
                            <th>S.N.</th>
                            <th>Item</th>
                            <th>Narration</th>
                            <th>Color</th>
                            <th>Unit</th>
                            <th>Shop Qty</th>
                            <th style="text-align: center">Bill Qty</th>
                            <th style="text-align: center" class="col-md-1 col-lg-1">Return
                                <br />
                                Qty<i style="color: red">*</i></th>
                            <th style="text-align: center">Rate</th>
                            <th style="text-align: center">Disc<br />
                                (%)</th>
                            <th style="text-align: center">Disc<br />
                                (<i class="fa fa-inr"></i>)</th>
                            <th style="text-align: center">Tax<br />
                                (%)</th>
                            <th style="text-align: center">Amt<br />
                                (<i class="fa fa-inr"></i>)</th>
                            <th></th>
                        </tr>
                       
                        <tbody id="DynamicRows">
                            @foreach (var item in Model.RetailBillItemList)
                            {
                                row = "Row" + rowid;
                                checkbox = "CheckBox" + rowid;
                                itemcode = "itemCode" + rowid;
                                quantity = "quantity" + rowid;
                                prevquantity = "prevquantity" + rowid;
                                prevquantityvalue = "prevquantityvalue" + rowid;
                                shopqty = "ShopQty" + rowid;
                                amount = "amount" + rowid;
                                amountvalue = "amountvalue" + rowid;
                                unitvalue = "unitvalue" + rowid;
                                numbertype = "numberType" + rowid;
                                ratevalue = "rate" + rowid;
                                mrp = "MRP" + rowid;
                                discountpercent = "discountpercent" + rowid;
                                discountrps = "discountrps" + rowid;
                                itemtax = "ItemTax" + rowid;
                                itemtaxvalue = "ItemTaxValue" + rowid;
                                itemtaxamount = "ItemTaxAmt" + rowid;

                                itemnamelabel = "itemnamelabel" + rowid;
                                narrationlabel = "narrationlabel" + rowid;
                                colorlabel = "colorlabel" + rowid;
                                ratelabel = "ratelabel" + rowid;
                                unitlabel = "unitlabel" + rowid;
                                discountpercentlabel = "discountpercentlabel" + rowid;
                                discountrpslabel = "discountrpslabel" + rowid;
                                <tr id="@row">
                                    @{
                                double Rate = Convert.ToDouble(@item.SellingPrice);
                                var rate = Rate.ToString("#,###.00##");
                                double disrs = Convert.ToDouble(@item.DiscountRPS);
                                var DisRs = disrs.ToString("#,###.00##");
                                double Amt = Convert.ToDouble(@item.Amount);
                                var amt = Amt.ToString("#,###.00##");
                                    
                                    }
                                    <td style="text-align: center">
                                        <input type="checkbox" id="@checkbox" name="@checkbox" onchange="CalculateRefundableAmount(@rowid)"/></td>
                                    <td>@rowid</td>
                                    <td>
                                        <label id="@itemnamelabel" style="font-weight:normal">@item.ItemName</label>
                                        <input type="hidden" id="@itemcode" name="@itemcode" value="@item.ItemCode" />
                                    </td>
                                    <td>
                                        <label id="@narrationlabel" style="font-weight:normal">@item.Narration</label></td>
                                    <td>
                                        <label id="@colorlabel" style="font-weight:normal">@item.Color</label></td>
                                    <td>
                                        <label id="@unitlabel" style="font-weight:normal">@item.Unit</label>
                                        <input type="hidden" id="@unitvalue" value="@item.Unit" />
                                        <input type="hidden" id="@numbertype" value="@item.NumberType" />
                                    </td>
                                    <td style="text-align: center">
                                        @{
                                if (item.ItemType == "Inventory")
                                {
                                            <label id="@shopqty"></label>
                                            <script type="text/javascript">
                                                GetShopQuantity("@rowid", "@item.ItemCode");
                                            </script>
                                }
                                else
                                {
                                            <label id="@shopqty">---</label>
                                }
                                        }
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@prevquantity">@item.Quantity</label>
                                        <input type="hidden" id="@prevquantityvalue" name="@prevquantityvalue" style="text-align:center" class="form-control" value="@item.Quantity" />
                                    </td>
                                    <td>
                                        <input type="text" style="text-align:center" id="@quantity" name="@quantity" autocomplete="off" disabled="disabled" onchange="CalculateRefundAmount(@rowid,'')" onkeypress="return AllowDecimal(event,@rowid)" class="form-control" value="@item.Quantity" />
                                        <script type="text/javascript">
                                            CalculateRefundAmount("@rowid", '');
                                        </script>
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@ratelabel" style="font-weight:normal">@rate</label>
                                        <input type="hidden" id="@ratevalue" name="@ratevalue" value="@item.SellingPrice" />
                                        <input type="hidden" id="@mrp" name="@mrp" value="@item.MRP" /></td>
                                    <td style="text-align: center">
                                        <label id="@discountpercentlabel" style="font-weight:normal">@item.DiscountPercent</label>
                                        <input type="hidden" id="@discountpercent" name="@discountpercent"  style="text-align:center" class="form-control" value="@item.DiscountPercent" />
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@discountrpslabel" style="font-weight:normal">@DisRs</label>
                                        <input type="hidden" id="@discountrps" name="@discountrps" style="text-align:center" class="form-control" value="@item.DiscountRPS" />
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@itemtax" style="font-weight:normal">@Convert.ToDouble(item.ItemTax)</label>
                                        <input type="hidden" id="@itemtaxvalue" name="@itemtaxvalue" value="@Convert.ToDouble(item.ItemTax)" />
                                        <input type="hidden" id="@itemtaxamount" name="@itemtaxamount" value="@item.ItemTaxAmt" /></td>
                                    <td style="text-align: center">
                                        <label id="@amount" style="font-weight:normal">@amt</label>
                                        <input type="hidden" id="@amountvalue" name="@amountvalue"  style="text-align:center" class="form-control" value="@item.Amount" />
                                    </td>
                                    <td></td>
                                </tr>

                                rowid = rowid + 1;
                            }
                            @{
                            rowid = Model.RetailBillItemList.Count() + 1;
                            }
                            @if (Model.RetailBillCreditNoteItemList != null && Model.RetailBillCreditNoteItemList.Any())
                            {
                                foreach (var item in Model.RetailBillCreditNoteItemList)
                                {
                                    row = "Row" + rowid;
                                    checkbox = "CheckBox" + rowid;
                                    itemcode = "itemCode" + rowid;
                                    amount = "amount" + rowid;
                                    amountvalue = "amountvalue" + rowid;
                                    unitvalue = "unitvalue" + rowid;
                                    numbertype = "numberType" + rowid;
                                    ratevalue = "rate" + rowid;
                                    mrp = "MRP" + rowid;
                                    quantity = "quantity" + rowid;
                                    prevquantity = "prevquantity" + rowid;
                                    prevquantityvalue = "prevquantityvalue" + rowid;
                                    shopqty = "ShopQty" + rowid;
                                    itemtax = "ItemTax" + rowid;
                                    itemtaxvalue = "ItemTaxValue" + rowid;
                                    itemtaxamount = "ItemTaxAmt" + rowid;
                                    discountpercent = "discountpercent" + rowid;
                                    discountrps = "discountrps" + rowid;

                                    itemnamelabel = "itemnamelabel" + rowid;
                                    narrationlabel = "narrationlabel" + rowid;
                                    colorlabel = "colorlabel" + rowid;
                                    ratelabel = "ratelabel" + rowid;
                                    unitlabel = "unitlabel" + rowid;
                                    discountpercentlabel = "discountpercentlabel" + rowid;
                                    discountrpslabel = "discountrpslabel" + rowid;
                                <tr id="@row">
                                    @{
                                
                                    double Rate = Convert.ToDouble(@item.SellingPrice);
                                    var rate = Rate.ToString("#,###.00##");
                                    double disrs = Convert.ToDouble(@item.DiscRs);
                                    var DisRs = disrs.ToString("#,###.00##");
                                    double Amt = Convert.ToDouble(@item.Amount);
                                    var amt = Amt.ToString("#,###.00##");
                                    }
                                    <td style="text-align: center">
                                        <input type="checkbox" id="@checkbox" name="@checkbox" onchange="CalculateRefundableAmount(@rowid)"/></td>
                                    <td>@rowid</td>
                                    <td>
                                        <label id="@itemnamelabel" style="font-weight:normal">@item.ItemName</label>
                                        <input type="hidden" id="@itemcode" name="@itemcode" value="@item.ItemCode" />
                                    </td>
                                    <td>
                                        <label id="@narrationlabel" style="font-weight:normal">@item.Narration</label></td>
                                    <td>
                                        <label id="@colorlabel" style="font-weight:normal">@item.Color</label></td>
                                    <td>
                                        <label id="@unitlabel" style="font-weight:normal">@item.Unit</label>
                                        <input type="hidden" id="@unitvalue" value="@item.Unit" />
                                        <input type="hidden" id="@numbertype" value="@item.NumberType" />
                                    </td>
                                    <td style="text-align: center">
                                        @{
                                    if (item.ItemType == "Inventory")
                                    {
                                            <label id="@shopqty"></label>
                                            <script type="text/javascript">
                                                GetShopQuantity("@rowid", "@item.ItemCode");
                                            </script>
                                    }
                                    else
                                    {
                                            <label id="@shopqty">---</label>
                                    }
                                        }
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@prevquantity">@item.Balance</label>
                                        <input type="hidden" id="@prevquantityvalue" name="@prevquantityvalue" style="text-align:center" class="form-control" value="@item.Balance" />
                                    </td>
                                    <td>
                                        <input type="text" style="text-align:center" id="@quantity" name="@quantity" autocomplete="off" disabled="disabled" onchange="CalculateRefundAmount(@rowid,'')" onkeypress="return AllowDecimal(event,@rowid)" class="form-control" value="@item.Balance" />
                                        <script type="text/javascript">
                                            CalculateRefundAmount("@rowid", '');
                                        </script>
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@ratelabel" style="font-weight:normal">@rate</label>
                                        <input type="hidden" id="@ratevalue" name="@ratevalue" value="@item.SellingPrice" />
                                        <input type="hidden" id="@mrp" name="@mrp" value="@item.MRP" /></td>
                                    <td style="text-align: center">
                                        <label id="@discountpercentlabel" style="font-weight:normal">@item.DiscPer</label>
                                        <input type="hidden" id="@discountpercent" name="@discountpercent"  style="text-align:center" class="form-control" value="@item.DiscPer" />
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@discountrpslabel" style="font-weight:normal">@DisRs</label>
                                        <input type="hidden" id="@discountrps" name="@discountrps" style="text-align:center" class="form-control" value="@item.DiscRs" />
                                    </td>
                                    <td style="text-align: center">
                                        <label id="@itemtax" style="font-weight:normal">@item.ItemTax</label>
                                        <input type="hidden" id="@itemtaxvalue" name="@itemtaxvalue" value="@item.ItemTax" />
                                        <input type="hidden" id="@itemtaxamount" name="@itemtaxamount" value="@item.ItemTaxAmt" /></td>
                                    <td style="text-align: center">
                                        <label id="@amount" style="font-weight:normal">@amt</label>
                                        <input type="hidden" id="@amountvalue" name="@amountvalue"  style="text-align:center" class="form-control" value="@item.Amount" />
                                    </td>
                                    <td></td>
                                </tr>
                                    rowid = rowid + 1;
                                }
                            }
                        </tbody>
                            
                            long ItemList = Model.RetailBillItemList.Count() + Model.RetailBillCreditNoteItemList.Count();
                            
                        <input type="hidden" id="ItemList" value="@ItemList" name="ItemList"/>
                        <input type="hidden" id="hdnRowCount" name="hdnRowCount" value="@ItemList" />
                        }
                    }
                </table>
            </div>
        </td>
    </tr>
</table>
<div class="row">
    <div class="col-md-12 col-lg-12">
        <div class="col-md-12 col-lg-12">
            <div class="row" id="NewItemButtons">
                <button class="btn btn-link col-md-offset-11 col-lg-offset-11" id="InvButton" type="button" style="float: right; text-align: right; color: royalblue; font-size: small">Inventory Item</button>
                <button class="btn btn-link col-md-offset-11 col-lg-offset-11" id="NonInvButton" type="button" style="float: right; text-align: right; color: orangered; font-size: small">Non-Inventory Item</button>
            </div>
        </div>
    </div>
</div>
<div>
    @{
        if (Model.SalesReturnDetails != null)
        {
        <div class="col-lg-7 col-md-7">
            <div class="row">
                <div class="col-md-3 col-lg-3">
                    <label style="font-size: 14px;">Total Discount:</label>
                </div>
                <div class="col-md-8 col-lg-8">
                    @{
            double Disc = Convert.ToDouble(@Model.SalesReturnDetails.TotalDiscount);
            var disc = Disc.ToString("#,###.00##");
                    }
                    <label id="TotalDiscountValue" style="font-size: 14px"><i class="fa fa-inr" style="font-size: 14px"></i>@disc</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 col-md-12">
                    <label style="font-size: 14px">Tax Summary:</label>
                </div>
            </div>
            <div id="ReturnAddTaxes">
                <div class="row">
                    <div class="col-md-3 col-lg-3">
                        <label id="ReturnAddedAmount1">0</label>
                        <input type="hidden" id="ReturnAddedAmounthdn1" name="ReturnAddedAmounthdn1" value="0" />
                    </div>
                    <div class="col-md-2 col-lg-2">
                        <label id="ReturnAddedTax1">0%</label>
                    </div>
                    <div class="col-md-3 col-lg-3">
                        <label id="ReturnAddedTaxAmount1">0</label>
                        <input type="hidden" id="ReturnAddedTaxAmounthdn1" name="ReturnAddedTaxAmounthdn1" value="0" />
                    </div>
                </div>
            </div>
            <div id="AddTaxes" style="display: none">
                @{
            if (Model.InventoryTaxList.Count() == 0)
            {
                    <div class="row">
                        <div class="col-md-3 col-lg-3">
                            <label id="AddedAmount1">0</label>
                            <input type="hidden" id="AddedAmounthdn1" name="AddedAmounthdn1" value="0" />
                        </div>
                        <div class="col-md-2 col-lg-2">
                            <label id="AddedTax1"></label>
                        </div>
                        <div class="col-md-7 col-lg-7">
                            <label id="AddedTaxAmount1">0</label>
                            <input type="hidden" id="AddedTaxAmounthdn1" name="AddedTaxAmounthdn1" value="0" />
                        </div>
                    </div>
            }
            else
            {
                int taxcount = 1;
                foreach (var tax in Model.InventoryTaxList)
                {
                    string addedtax = "AddedTax" + taxcount;
                    string taxnumber = "ItemTaxNumber" + taxcount;
                    string addedtaxamount = "AddedTaxAmount" + taxcount;
                    string addedtaxhdn = "AddedTaxAmounthdn" + taxcount;
                    string addedamount = "AddedAmount" + taxcount;
                    string addedamounthdn = "AddedAmounthdn" + taxcount;
                    string itemtax = tax.Tax + "%";
                    <div class="row">
                        <div class="col-md-3 col-lg-3">
                            <label id="@addedamount">@tax.Amount</label>
                            <input type="hidden" id="@addedamounthdn" name="@addedamounthdn" value="@tax.Amount" />
                        </div>
                        <div class="col-md-2 col-lg-2">
                            <label id="@addedtax">@itemtax</label>
                            <input type="hidden" id="@taxnumber" name="@taxnumber" value="@tax.Tax" />
                        </div>
                        <div class="col-md-7 col-lg-7">
                            <label id="@addedtaxamount"><i class="fa fa-inr"></i>@tax.TaxAmount</label>
                            <input type="hidden" id="@addedtaxhdn" name="@addedtaxhdn" value="@tax.TaxAmount" />
                        </div>
                    </div>
                    taxcount++;
                }

            }
                }
            </div>
        </div>
        <div class="col-lg-5 col-md-5">
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Total Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <label id="TotalAmount">@Html.DisplayFor(model => model.SalesReturnDetails.TotalAmount)</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Tax Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <label id="TotalTaxAmount">@Html.DisplayFor(model => model.SalesReturnDetails.TotalTaxAmount)</label>
                </div>
            </div>
            @{
            if (Model.SalesReturnDetails.BillNo.Contains("S"))
            {
                <div class="row">
                    <div class="col-lg-8 col-md-8" style="text-align: right">
                        <label style="font-size: 14px;">Packaging and Fordwarding:</label>
                    </div>
                    <div class="col-lg-4 col-md-4" style="text-align: right">
                        @Html.TextBoxFor(model => model.SalesReturnDetails.PackAndForwd, new { @id = "PackAndForwd", @autocomplete = "off", @class = "form-control", @style = "text-align:right", @placeholder = "0", @onchange = "CalculatePackAndForwd()", @onkeypress = "return AllowNumbers(event)" })
                    </div>
                </div>
            }
            }
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Grand Total:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <label id="GrandTotal">@Html.DisplayFor(model => model.SalesReturnDetails.GrandTotal)</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Refundable Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: green"></i>&nbsp;<label id="RefundableAmountLabel" style="color: green">0</label>
                    <input type="hidden" id="RefundableAmount" name="RefundableAmount" />
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Sales Return Balance:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: red"></i>&nbsp;<label id="AmountBalance" style="color: red">0</label>
                    <input type="hidden" id="AmountBalanceValue" name="AmountBalanceValue" />
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Refund:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: green"></i>&nbsp;<label id="RefundAmount" style="color: green">0</label>
                    <input type="hidden" id="RefundAmountValue" name="RefundAmountValue" />
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Credit Note Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: green"></i>&nbsp;<label id="CreditNoteAmount" style="color: green">0</label>
                </div>
            </div>
        </div>
        }
        else if (Model.RetailBillDetails != null)
        {
        <div class="col-lg-7 col-md-7">
            <div class="row">
                <div class="col-md-3 col-lg-3">
                    <label style="font-size: 14px;">Total Discount:</label>
                </div>
                <div class="col-md-8 col-lg-8">
                    @{
            double Disc = Convert.ToDouble(@Model.RetailBillDetails.TotalDiscount);
            var disc = Disc.ToString("#,###.00##");
                    }
                    <label id="TotalDiscountValue" style="font-size: 14px"><i class="fa fa-inr" style="font-size: 14px"></i>@disc</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 col-md-12">
                    <label style="font-size: 14px">Tax Summary:</label>
                </div>
            </div>
            <div id="ReturnAddTaxes">
                <div class="row">
                    <div class="col-md-3 col-lg-3">
                        <label id="ReturnAddedAmount1">0</label>
                        <input type="hidden" id="ReturnAddedAmounthdn1" name="ReturnAddedAmounthdn1" value="0" />
                    </div>
                    <div class="col-md-2 col-lg-2">
                        <label id="ReturnAddedTax1">0%</label>
                    </div>
                    <div class="col-md-3 col-lg-3">
                        <label id="ReturnAddedTaxAmount1">0</label>
                        <input type="hidden" id="ReturnAddedTaxAmounthdn1" name="ReturnAddedTaxAmounthdn1" value="0" />
                    </div>
                </div>
            </div>
            <div id="AddTaxes" style="display: none">
                @{
            if (Model.InventoryTaxList.Count() == 0)
            {
                    <div class="row">
                        <div class="col-md-3 col-lg-3">
                            <label id="AddedAmount1">0</label>
                            <input type="hidden" id="AddedAmounthdn1" name="AddedAmounthdn1" value="0" />
                        </div>
                        <div class="col-md-2 col-lg-2">
                            <label id="AddedTax1"></label>
                        </div>
                        <div class="col-md-7 col-lg-7">
                            <label id="AddedTaxAmount1">0</label>
                            <input type="hidden" id="AddedTaxAmounthdn1" name="AddedTaxAmounthdn1" value="0" />
                        </div>
                    </div>
            }
            else
            {
                int taxcount = 1;
                foreach (var tax in Model.InventoryTaxList)
                {
                    string addedtax = "AddedTax" + taxcount;
                    string taxnumber = "ItemTaxNumber" + taxcount;
                    string addedtaxamount = "AddedTaxAmount" + taxcount;
                    string addedtaxhdn = "AddedTaxAmounthdn" + taxcount;
                    string addedamount = "AddedAmount" + taxcount;
                    string addedamounthdn = "AddedAmounthdn" + taxcount;
                    string itemtax = tax.Tax + "%";
                    <div class="row">
                        <div class="col-md-3 col-lg-3">
                            <label id="@addedamount">@tax.Amount</label>
                            <input type="hidden" id="@addedamounthdn" name="@addedamounthdn" value="@tax.Amount" />
                        </div>
                        <div class="col-md-2 col-lg-2">
                            <label id="@addedtax">@itemtax</label>
                            <input type="hidden" id="@taxnumber" name="@taxnumber" value="@tax.Tax" />
                        </div>
                        <div class="col-md-7 col-lg-7">
                            <label id="@addedtaxamount"><i class="fa fa-inr"></i>@tax.TaxAmount</label>
                            <input type="hidden" id="@addedtaxhdn" name="@addedtaxhdn" value="@tax.TaxAmount" />
                        </div>
                    </div>
                    taxcount++;
                }

            }
                }
            </div>
        </div>
        <div class="col-lg-5 col-md-5">
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Total Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <label id="TotalAmount">@Html.DisplayFor(model => model.RetailBillDetails.TotalAmount)</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Tax Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <label id="TotalTaxAmount">@Html.DisplayFor(model => model.RetailBillDetails.TotalTaxAmount)</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Grand Total:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <label id="GrandTotal">@Html.DisplayFor(model => model.RetailBillDetails.GrandTotal)</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Payment:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <label id="AdvancePayment">@Html.DisplayFor(model => model.RetailBillDetails.Payment)</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Refundable Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: green"></i>&nbsp;<label id="RefundableAmountLabel" style="color: green">0</label>
                    <input type="hidden" id="RefundableAmount" name="RefundableAmount" />
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Sales Return Balance:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: red"></i>&nbsp;<label id="AmountBalance" style="color: red">0</label>
                    <input type="hidden" id="AmountBalanceValue" name="AmountBalanceValue" />
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Refund:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: green"></i>&nbsp;<label id="RefundAmount" style="color: green">0</label>
                    <input type="hidden" id="RefundAmountValue" name="RefundAmountValue" />
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Credit Note Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: green"></i>&nbsp;<label id="CreditNoteAmount" style="color: green">0</label>
                </div>
            </div>
        </div>
        }
        else
        {
        <div class="col-lg-7 col-md-7">
            <div class="row">
                <div class="col-md-3 col-lg-3">
                    <label style="font-size: 14px;">Total Discount:</label>
                </div>
                <div class="col-md-8 col-lg-8">
                    @{
            double Disc = Convert.ToDouble(@Model.SalesBillDetails.TotalDiscount);
            var disc = Disc.ToString("#,###.00##");
                    }
                    <label id="TotalDiscountValue" style="font-size: 14px"><i class="fa fa-inr" style="font-size: 14px"></i>@disc</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 col-md-12">
                    <label style="font-size: 14px">Tax Summary:</label>
                </div>
            </div>
            <div id="ReturnAddTaxes">
                <div class="row">
                    <div class="col-md-3 col-lg-3">
                        <label id="ReturnAddedAmount1">0</label>
                        <input type="hidden" id="ReturnAddedAmounthdn1" name="ReturnAddedAmounthdn1" value="0" />
                    </div>
                    <div class="col-md-2 col-lg-2">
                        <label id="ReturnAddedTax1">0%</label>
                    </div>
                    <div class="col-md-3 col-lg-3">
                        <label id="ReturnAddedTaxAmount1">0</label>
                        <input type="hidden" id="ReturnAddedTaxAmounthdn1" name="ReturnAddedTaxAmounthdn1" value="0" />
                    </div>
                </div>
            </div>
            <div id="AddTaxes" style="display: none">
                @{
            if (Model.InventoryTaxList.Count() == 0)
            {
                    <div class="row">
                        <div class="col-md-3 col-lg-3">
                            <label id="AddedAmount1">0</label>
                            <input type="hidden" id="AddedAmounthdn1" name="AddedAmounthdn1" value="0" />
                        </div>
                        <div class="col-md-2 col-lg-2">
                            <label id="AddedTax1"></label>
                        </div>
                        <div class="col-md-7 col-lg-7">
                            <label id="AddedTaxAmount1">0</label>
                            <input type="hidden" id="AddedTaxAmounthdn1" name="AddedTaxAmounthdn1" value="0" />
                        </div>
                    </div>
            }
            else
            {
                int taxcount = 1;
                foreach (var tax in Model.InventoryTaxList)
                {
                    string addedtax = "AddedTax" + taxcount;
                    string taxnumber = "ItemTaxNumber" + taxcount;
                    string addedtaxamount = "AddedTaxAmount" + taxcount;
                    string addedtaxhdn = "AddedTaxAmounthdn" + taxcount;
                    string addedamount = "AddedAmount" + taxcount;
                    string addedamounthdn = "AddedAmounthdn" + taxcount;
                    string itemtax = tax.Tax + "%";
                    <div class="row">
                        <div class="col-md-3 col-lg-3">
                            <label id="@addedamount">@tax.Amount</label>
                            <input type="hidden" id="@addedamounthdn" name="@addedamounthdn" value="@tax.Amount" />
                        </div>
                        <div class="col-md-2 col-lg-2">
                            <label id="@addedtax">@itemtax</label>
                            <input type="hidden" id="@taxnumber" name="@taxnumber" value="@tax.Tax" />
                        </div>
                        <div class="col-md-7 col-lg-7">
                            <label id="@addedtaxamount"><i class="fa fa-inr"></i>@tax.TaxAmount</label>
                            <input type="hidden" id="@addedtaxhdn" name="@addedtaxhdn" value="@tax.TaxAmount" />
                        </div>
                    </div>
                    taxcount++;
                }

            }
                }
            </div>
        </div>
        <div class="col-lg-5 col-md-5">
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Total Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <label id="TotalAmount">@Html.DisplayFor(model => model.SalesBillDetails.TotalAmount)</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Tax Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <label id="TotalTaxAmount">@Html.DisplayFor(model => model.SalesBillDetails.TotalTaxAmount)</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Packaging and Fordwarding:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    @Html.TextBoxFor(model => model.SalesBillDetails.PackAndForwd, new { @id = "PackAndForwd", @class = "form-control", @autocomplete = "off", @style = "text-align:right", @placeholder = "0", @onchange = "CalculatePackAndForwd()", @onkeypress = "return AllowNumbers(event)" })
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Grand Total:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <label id="GrandTotal">@Html.DisplayFor(model => model.SalesBillDetails.GrandTotal)</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Payment Received:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <label id="AdvancePayment">@Html.DisplayFor(model => model.SalesBillDetails.PaymentReceived)</label>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Refundable Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: green"></i>&nbsp;<label id="RefundableAmountLabel" style="color: green">0</label>
                    <input type="hidden" id="RefundableAmount" name="RefundableAmount" />
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Sales Return Balance:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: red"></i>&nbsp;<label id="AmountBalance" style="color: red">0</label>
                    <input type="hidden" id="AmountBalanceValue" name="AmountBalanceValue" />
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Refund:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: green"></i>&nbsp;<label id="RefundAmount" style="color: green">0</label>
                    <input type="hidden" id="RefundAmountValue" name="RefundAmountValue" />
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-8" style="text-align: right">
                    <label style="font-size: 14px;">Credit Note Amount:</label>
                </div>
                <div class="col-lg-4 col-md-4" style="text-align: right">
                    <i class="fa fa-inr" style="color: green"></i>&nbsp;<label id="CreditNoteAmount" style="color: green">0</label>
                </div>
            </div>
        </div>
        }
    }
</div>

